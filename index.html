
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evo?</title>
     <script>

(function() {
    const chromebookCheck = () => {
        // PRODUCTION CODE (currently commented out for testing):
        // const ua = navigator.userAgent.toLowerCase();
        // const platform = navigator.platform.toLowerCase();
        // 
        // // Check for ChromeOS indicators
        // const isChromeOS = ua.includes('cros') || 
        //                    platform.includes('cros') ||
        //                    ua.includes('chromebook');
        // 
        // // Additional check for Chrome on ChromeOS
        // const isChrome = ua.includes('chrome') && !ua.includes('edge');
        // 
        // return isChromeOS && isChrome;
        
        // DEBUG MODE - Remove this line in production:
        return true;  // ‚ö†Ô∏è DEBUG: Allows all devices
    };
            
            if (!chromebookCheck()) {
                document.addEventListener('DOMContentLoaded', () => {
                    document.body.innerHTML = `
                        <div style="
                            position: fixed;
                            top: 0; left: 0;
                            width: 100vw; height: 100vh;
                            background: #0a0a0a;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            flex-direction: column;
                            z-index: 999999;
                        ">
                            <h1 style="color: #ff4444; font-size: 48px; margin-bottom: 20px;">‚ö†Ô∏è ACCESS DENIED</h1>
                            <p style="color: #ccc; font-size: 18px;">This application is only accessible on ChromeOS devices.</p>
                            <p style="color: #888; font-size: 14px; margin-top: 10px;">Detected: ${navigator.userAgent}</p>
                        </div>
                    `;
                });
                window._chromeOSValid = false;
            } else {
                window._chromeOSValid = true;
            }
        })();

         (async function() {
    const BANNED_IPS = ['1.2.3.4', '5.6.7.8']; // Replace with actual banned IPs
    
    try {
        const response = await fetch('https://api.ipify.org?format=json');
        const data = await response.json();
        const userIP = data.ip;
        
        if (BANNED_IPS.includes(userIP)) {
            document.body.innerHTML = `
                <div style="
                    position: fixed;
                    top: 0; left: 0;
                    width: 100vw; height: 100vh;
                    background: #0a0a0a;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    flex-direction: column;
                    z-index: 999999;
                ">
                    <h1 style="color: #ff4444; font-size: 48px; margin-bottom: 20px;">üö´ ACCESS DENIED</h1>
                    <p style="color: #ccc; font-size: 18px;">Your access has been permanently revoked.</p>
                </div>
            `;
            throw new Error('Banned IP');
        }
    } catch(e) {
        if (e.message === 'Banned IP') throw e;
    }
})();
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: #0a0a0a;
            color: #fff;
            overflow-x: hidden;
        }
        #passwordScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: #0a0a0a;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }
        #passwordScreen h1 {
            font-size: 48px;
            font-weight: 300;
            letter-spacing: 3px;
            margin-bottom: 30px;
        }
        #passwordInput {
            padding: 16px 24px;
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            color: #fff;
            font-size: 16px;
            outline: none;
            width: 300px;
            text-align: center;
            margin-bottom: 20px;
        }
        #passwordInput:focus {
            border-color: #555;
        }
        #unlockBtn {
            padding: 16px 32px;
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            color: #fff;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.2s;
        }
        #unlockBtn:hover {
            background: #252525;
            border-color: #555;
        }
        .error-message {
            color: #ff4444;
            font-size: 14px;
            margin-top: 10px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .error-message.show {
            opacity: 1;
        }
        #mainView {
            min-height: 100vh;
            padding: 40px 20px;
            display: none;
            flex-direction: column;
            align-items: center;
        }
        #coinDisplay {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #1a1a1a;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            border: 1px solid #333;
            z-index: 100;
        }
        .container {
            max-width: 800px;
            width: 100%;
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 32px;
            font-weight: 300;
            letter-spacing: 2px;
        }
        .search-container {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        #searchBox {
            flex: 1;
            padding: 12px 16px;
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 6px;
            color: #fff;
            font-size: 14px;
            outline: none;
            transition: border-color 0.2s;
        }
        #searchBox:focus {
            border-color: #555;
        }
        button {
            padding: 12px 24px;
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 6px;
            color: #fff;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }
        button:hover {
            background: #252525;
            border-color: #555;
        }
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        #gameList {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 12px;
        }
        .game-btn {
            padding: 16px;
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 6px;
            color: #fff;
            cursor: pointer;
            font-size: 13px;
            text-align: left;
            transition: all 0.2s;
            width: 100%;
            position: relative;
        }
        .game-btn:hover {
            background: #252525;
            border-color: #555;
            transform: translateY(-2px);
        }
        .game-btn.locked {
            opacity: 0.6;
            border-color: #d69e2e;
        }
.game-btn.locked:after {
    content: var(--lock-text, 'üîí 50 coins');
    display: block;
    font-size: 11px;
    color: #d69e2e;
    margin-top: 4px;
}
        
#gameView {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: #000;
    z-index: 100;
}
#backBtn {
    position: fixed;
    top: 10px;
    left: 10px;
    z-index: 10000;
    padding: 6px 14px;
    font-size: 11px;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease, transform 0.2s ease;
}

#gameView:hover #backBtn {
    opacity: 0.9;
    pointer-events: auto;
}

#backBtn:hover {
    opacity: 1 !important;
    transform: scale(1.05);
}
#gameFrame:not(.mobile-game) {
    width: 100%;
    height: 100%;
    border: none;
}
#gameFrame.mobile-game {
    top: 50%;
    left: 75%;
    width: 100%;
    height: 100%;
    border: none;
}
        #adOverlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0,0,0,0.95);
            z-index: 99999;
        }
        #adOverlay.show {
    display: flex;
    align-items: center;
    justify-content: center;
}
.ad-content {
    text-align: center;
    padding: 50px 60px;
    background: #1a1a1a;
    border-radius: 12px;
    border: 2px solid #d69e2e;
    min-width: 400px;
    max-width: 90vw;
}
        #adTitle {
            font-size: 32px;
            margin-bottom: 20px;
            color: #d69e2e;
            font-weight: bold;
        }
        #adText {
            font-size: 18px;
            margin-bottom: 30px;
            color: #ccc;
            line-height: 1.5;
        }
        #adTimer {
            font-size: 24px;
            color: #fff;
            margin-bottom: 25px;
            font-weight: bold;
        }
        #adCountdown {
            color: #d69e2e;
            font-size: 28px;
        }
        #skipAdBtn {
            padding: 15px 40px;
            background: #d69e2e;
            border: none;
            border-radius: 8px;
            color: #000;
            font-weight: bold;
            cursor: pointer;
            font-size: 18px;
            display: none;
        }
        #skipAdBtn:hover {
            background: #b7791f;
        }
        .dev-section {
            margin-top: 40px;
            padding-top: 40px;
            border-top: 1px solid #333;
        }
        #devInput {
            padding: 12px 16px;
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 6px;
            color: #fff;
            font-size: 14px;
            outline: none;
            width: 200px;
        }
        .trade-code-display {
            padding: 12px 16px;
            background: #1a1a1a;
            border: 1px solid #555;
            border-radius: 6px;
            font-size: 11px;
            font-family: monospace;
            word-break: break-all;
            color: #aaa;
            cursor: pointer;
            margin-bottom: 5px;
        }
        .trade-code-display:hover {
            background: #252525;
        }
        small {
            color: #666;
            font-size: 12px;
        }
        #userStatus.admin {
    color: #ff4444;
    font-weight: bold;
}
        #userStatus.moderator {
    color: #90ee90; /* Light green */
    font-weight: bold;
}
#userStatus.sr-admin {
    color: #8b0000; /* Dark red/maroon */
    font-weight: bold;
}
#userStatus.owner {
    color: #a855f7;
    font-weight: bold;
}
#userStatus.legendary {
    color: #ffd700;
    font-weight: bold;
}
        #userStatus.rare {
    color: #3b82f6;
    font-weight: bold;
}
#userStatus.legendary {
    color: #ffd700;
    font-weight: bold;
}
#userStatus.mystical {
    color: #008c99;
    font-weight: bold;
    text-shadow: 0 0 10px rgba(168, 85, 247, 0.5);
}
#userDisplay:hover > div {
    background: #252525 !important;
    border-color: #555 !important;
    transform: translateY(-2px);
}
#playerSphere {
    display: block;
    margin: 0 auto 10px;
    /* No width/height restrictions - let it be its natural size */
}
#lightningIcon {
    position: fixed;
    top: 20px;
    left: 20px;
    width: 60px;
    height: 60px;
    background: linear-gradient(135deg, #ffff00 0%, #ffd700 100%);
    border: 3px solid #fff;
    border-radius: 50%;
    display: none;
    align-items: center;
    justify-content: center;
    font-size: 32px;
    cursor: pointer;
    z-index: 1000;
    transition: all 0.2s;
    box-shadow: 0 4px 15px rgba(255, 255, 0, 0.5);
}
#lightningIcon:hover {
    transform: scale(1.1);
    box-shadow: 0 6px 20px rgba(255, 255, 0, 0.7);
}
#lightningIcon.active {
    animation: pulse 1s infinite;
}
@keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
}
@keyframes sparkle {
    0%, 100% { box-shadow: 0 0 10px rgba(255, 215, 0, 0.5); transform: scale(1); }
    50% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.8); transform: scale(1.05); }
}

#chatContainer {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 350px;
    height: 500px;
    background: #1a1a1a;
    border: 2px solid #333;
    border-radius: 12px;
    display: none;
    flex-direction: column;
    z-index: 10000;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
}
#chatContainer.show {
    display: flex;
}
#chatHeader {
    padding: 15px;
    border-bottom: 2px solid #333;
    font-weight: bold;
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
    border-radius: 10px 10px 0 0;
}

.chat-tab {
    padding: 6px 12px;
    background: #0a0a0a;
    border: 1px solid #333;
    border-radius: 4px;
    color: #888;
    font-size: 12px;
    cursor: pointer;
    transition: all 0.2s;
}

.chat-tab:hover {
    background: #1a1a1a;
    border-color: #555;
}

.chat-tab.active {
    background: #d69e2e;
    border-color: #d69e2e;
    color: #000;
    font-weight: bold;
}
#chatOnlineCount {
    font-size: 12px;
    color: #4ade80;
    font-weight: normal;
}
#closeChat {
    background: none;
    border: none;
    color: #fff;
    cursor: pointer;
    font-size: 20px;
    padding: 0;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
    transition: background 0.2s;
}
#closeChat:hover {
    background: #333;
}
#chatMessages {
    flex: 1;
    overflow-y: auto;
    padding: 15px;
    display: flex;
    flex-direction: column;
    gap: 10px;
}
#chatMessages::-webkit-scrollbar {
    width: 8px;
}
#chatMessages::-webkit-scrollbar-track {
    background: #0a0a0a;
    border-radius: 4px;
}
#chatMessages::-webkit-scrollbar-thumb {
    background: #333;
    border-radius: 4px;
}
#chatMessages::-webkit-scrollbar-thumb:hover {
    background: #555;
}
.chat-message {
    padding: 8px 12px;
    background: #0a0a0a;
    border-radius: 8px;
    border-left: 3px solid #333;
    animation: slideInChat 0.2s ease-out;
}
@keyframes slideInChat {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}
.chat-username {
    font-weight: bold;
    margin-right: 5px;
    font-size: 13px;
}
.chat-status-badge {
    font-size: 11px;
    padding: 2px 6px;
    border-radius: 4px;
    margin-left: 5px;
    font-weight: bold;
}
.chat-status-badge.admin {
    background: #ff4444;
    color: #000;
}
.chat-status-badge.owner {
    background: #a855f7;
    color: #fff;
}
.chat-status-badge.sr\.admin {
    background: #8b0000; /* Maroon */
    color: #fff;
}

.chat-status-badge.moderator {
    background: #90ee90; /* Light green */
    color: #000;
}
.chat-status-badge.legendary {
    background: #ffd700;
    color: #000;
}
.chat-status-badge.rare {
    background: #3b82f6;
    color: #fff;
}
.chat-status-badge.mystical {
    background: linear-gradient(135deg, #008c99 0%, #00d9ff 100%);
    color: #fff;
}
.chat-status-badge.player {
    background: #333;
    color: #ccc;
}
.chat-text {
    color: #ccc;
    font-size: 14px;
    word-wrap: break-word;
    display: block;
    margin-top: 4px;
}
.chat-system {
    text-align: center;
    color: #888;
    font-size: 12px;
    font-style: italic;
}
#chatInputContainer {
    padding: 15px;
    border-top: 2px solid #333;
    background: #0a0a0a;
    border-radius: 0 0 10px 10px;
}
.donate-section-chat {
    margin-bottom: 10px;
}

#chatInput {
    width: 100%;
    padding: 10px 12px;
    background: #1a1a1a;
    border: 1px solid #333;
    border-radius: 6px;
    color: #fff;
    font-size: 14px;
    outline: none;
    transition: border-color 0.2s;
}
#chatInput:focus {
    border-color: #555;
}
#chatToggleBtn {
    position: fixed;
    bottom: 20px;
    left: 20px;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: linear-gradient(135deg, #d69e2e 0%, #ffd700 100%);
    border: none;
    font-size: 28px;
    cursor: pointer;
    z-index: 9999;
    box-shadow: 0 4px 15px rgba(214, 158, 46, 0.4);
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
}
#chatToggleBtn:hover {
    transform: scale(1.1);
    box-shadow: 0 6px 20px rgba(214, 158, 46, 0.6);
}
#chatToggleBtn.has-unread {
    animation: bounceChat 0.5s ease infinite;
}
@keyframes bounceChat {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
}
.connection-status {
    font-size: 11px;
    padding: 4px 8px;
    border-radius: 4px;
    margin-left: 10px;
}
.connection-status.connected {
    background: #4ade80;
    color: #000;
}
.connection-status.disconnected {
    background: #ff4444;
    color: #fff;
}
        .donate-section {
    background: #0a0a0a;
    border: 1px solid #ffd700;
    border-radius: 8px;
    padding: 12px;
    margin-bottom: 10px;
}
.donate-section h4 {
    color: #ffd700;
    margin-bottom: 8px;
    font-size: 13px;
}
.donate-form {
    display: flex;
    gap: 6px;
    flex-wrap: wrap;
}
.donate-form input,
.donate-form select {
    padding: 6px 8px;
    background: #1a1a1a;
    border: 1px solid #333;
    border-radius: 4px;
    color: #fff;
    font-size: 12px;
}
.donate-form input {
    flex: 1;
    min-width: 80px;
}
.donate-form select {
    width: 70px;
}
.donate-btn {
    padding: 6px 12px;
    background: #ffd700;
    border: none;
    border-radius: 4px;
    color: #000;
    font-weight: bold;
    cursor: pointer;
    font-size: 12px;
}
.donate-btn:hover {
    background: #d69e2e;
}
.chat-message.donation {
    border-left-color: #ffd700;
    background: linear-gradient(90deg, #0a0a0a 0%, rgba(255, 215, 0, 0.1) 100%);
}
        .chat-nametag-badge {
    font-size: 10px;
    padding: 2px 6px;
    border-radius: 4px;
    margin-left: 5px;
    font-weight: bold;
}
.chat-nametag-badge.warhero {
    background: linear-gradient(135deg, #dc2626 0%, #7f1d1d 100%);
    color: #fff;
}
.chat-nametag-badge.donator {
    background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
    color: #000;
}
        .chat-nametag-badge.rich {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    color: #fff;
}
.chat-nametag-badge.m0gged {
    background: linear-gradient(135deg, #a855f7 0%, #7c3aed 100%);
    color: #fff;
}
.chat-nametag-badge.secret {
    background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);
    color: #fff;
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
    border: 1px solid #333;
}
    .chat-nametag-badge.cracked {
    background: linear-gradient(135deg, #ff6b00 0%, #ff0000 100%);
    color: #fff;
    text-shadow: 0 0 10px rgba(255, 107, 0, 0.5);
    animation: crackedPulse 2s infinite;
}
@keyframes crackedPulse {
    0%, 100% { box-shadow: 0 0 5px rgba(255, 107, 0, 0.5); }
    50% { box-shadow: 0 0 15px rgba(255, 0, 0, 0.8); }
}

.chat-nametag-badge.cosmic {
    background: linear-gradient(135deg, #1a0033 0%, #330066 25%, #6600cc 50%, #9933ff 75%, #cc66ff 100%);
    color: #fff;
    animation: cosmicSwirl 3s infinite linear;
    background-size: 200% 200%;
}
@keyframes cosmicSwirl {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}


.chat-nametag-badge.bloodlust {
    background: linear-gradient(180deg, #8b0000 0%, #dc143c 50%, #8b0000 100%);
    color: #fff;
    animation: bloodDrip 2s infinite;
}
@keyframes bloodDrip {
    0%, 100% { 
        box-shadow: 0 2px 5px rgba(139, 0, 0, 0.5);
    }
    50% { 
        box-shadow: 0 4px 15px rgba(220, 20, 60, 0.9), 0 8px 25px rgba(139, 0, 0, 0.6);
    }
}


.chat-nametag-badge.diamond {
    background: linear-gradient(135deg, #b9f2ff 0%, #00d4ff 50%, #0080ff 100%);
    color: #000;
    font-weight: bold;
    animation: diamondShimmer 2s infinite;
}
@keyframes diamondShimmer {
    0% { box-shadow: 0 0 5px rgba(0, 212, 255, 0.5); filter: hue-rotate(0deg); }
    25% { box-shadow: 0 0 15px rgba(185, 242, 255, 0.8); filter: hue-rotate(90deg); }
    50% { box-shadow: 0 0 5px rgba(0, 128, 255, 0.5); filter: hue-rotate(180deg); }
    75% { box-shadow: 0 0 15px rgba(0, 212, 255, 0.8); filter: hue-rotate(270deg); }
    100% { box-shadow: 0 0 5px rgba(185, 242, 255, 0.5); filter: hue-rotate(360deg); }
}

.chat-nametag-badge.rotted {
    background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
    color: #68d391;
    border: 1px solid #4a5568;
    text-shadow: 0 0 8px rgba(104, 211, 145, 0.3);
}
        .chat-nametag-badge.freebird {
    background: linear-gradient(135deg, #87ceeb 0%, #1e90ff 100%);
    color: #fff;
    animation: freebirdglow 2s ease-in-out infinite alternate;
}

@keyframes freebirdglow {
    from { box-shadow: 0 0 5px rgba(30, 144, 255, 0.5); }
    to { box-shadow: 0 0 15px rgba(135, 206, 235, 0.8); }
}
        /* CELESTIAL - Starry cosmic effect */
.chat-nametag-badge.celestial {
    background: linear-gradient(135deg, #0f0f23 0%, #1a1a3e 50%, #0f0f23 100%);
    color: #fff;
    position: relative;
    overflow: hidden;
    animation: celestialGlow 3s ease-in-out infinite;
}

.chat-nametag-badge.celestial::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
    animation: celestialShine 2s infinite;
}

@keyframes celestialGlow {
    0%, 100% { 
        box-shadow: 0 0 10px rgba(138, 43, 226, 0.5), inset 0 0 10px rgba(138, 43, 226, 0.2);
    }
    50% { 
        box-shadow: 0 0 20px rgba(138, 43, 226, 0.8), inset 0 0 15px rgba(138, 43, 226, 0.4);
    }
}

@keyframes celestialShine {
    0% { left: -100%; }
    100% { left: 50%; }
}
/* ETHEREAL - Ghostly spectral effect */
.chat-nametag-badge.ethereal {
    background: linear-gradient(135deg, rgba(230, 230, 250, 0.3) 0%, rgba(221, 160, 221, 0.3) 100%);
    color: #e6e6fa;
    backdrop-filter: blur(5px);
    border: 1px solid rgba(230, 230, 250, 0.5);
    animation: etherealFloat 3s ease-in-out infinite, etherealFade 2s ease-in-out infinite alternate;
    text-shadow: 0 0 8px rgba(230, 230, 250, 0.8);
}

@keyframes etherealFloat {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-3px); }
}

@keyframes etherealFade {
    0% { opacity: 0.7; }
    100% { opacity: 1; }
}

/* PRISMATIC - Rainbow refraction effect */
.chat-nametag-badge.prismatic {
    background: linear-gradient(135deg, #ff0000 0%, #ff7f00 14%, #ffff00 28%, #00ff00 42%, #0000ff 57%, #4b0082 71%, #9400d3 85%, #ff0000 100%);
    background-size: 200% 200%;
    color: #fff;
    font-weight: bold;
    animation: prismaticShift 3s linear infinite, prismaticGlow 1.5s ease-in-out infinite alternate;
    text-shadow: 0 0 5px rgba(0, 0, 0, 0.8);
    border: 2px solid #fff;
}

@keyframes prismaticShift {
    0% { background-position: 0% 50%; filter: hue-rotate(0deg); }
    100% { background-position: 200% 50%; filter: hue-rotate(360deg); }
}

@keyframes prismaticGlow {
    from { box-shadow: 0 0 10px rgba(255, 255, 255, 0.5); }
    to { box-shadow: 0 0 20px rgba(255, 255, 255, 0.8); }
}
        #requestPasswordBtn {
    padding: 16px 32px;
    border: 1px solid #059669;
    border-radius: 8px;
    color: #fff;
    cursor: pointer;
    font-size: 16px;
    transition: all 0.2s;
}
#requestPasswordBtn:hover {
    background: #059669 !important;
    border-color: #047857 !important;
}
    </style>
    <script src="PlayerSphere.js"></script>
    <script src="relay-client.js"></script>
</head>
<body>
    <div id="passwordScreen">
        <h1>üîí LOCKED</h1>
        <input type="password" id="passwordInput" placeholder="Enter password...">
        <button id="unlockBtn">UNLOCK</button>
        <div class="error-message" id="errorMessage">Incorrect password</div>
        <button id="requestPasswordBtn" style="margin-top: 20px; background: #10b981; border-color: #059669;">REQUEST PASSWORD üìß</button>
    </div>

    <div id="mainView">
<div id="userDisplay" style="position: fixed; top: 20px; right: 20px; z-index: 100; cursor: pointer;" onclick="window.location.href='player.html'">
    <div style="background: #1a1a1a; padding: 15px; border-radius: 12px; border: 1px solid #333; text-align: center; transition: all 0.2s; width: 200px; height: 250px; overflow: visible;">
        <canvas id="playerSphere" width="150" height="150" style="display: block; margin: 0 auto 10px;"></canvas>
        <div id="userName" style="font-size: 16px; font-weight: bold; margin-bottom: 5px;">guest000000</div>
        <div id="userStatus" style="font-size: 14px; margin-bottom: 8px;">player</div>
        <div style="font-size: 13px; color: #d69e2e;">üí∞ <span id="coinAmountTop">10</span> | üíé <span id="gemAmountTop">0</span></div>
    </div>
    
</div>
        <div id="lightningIcon" title="Lightning Blade: Double Profit">‚ö°</div>
        <div class="container">
            <h1>Evo?</h1>
            <div class="search-container">
                <input type="text" id="searchBox" placeholder="Search games...">
                <button id="allBtn">ALL</button>
                <button id="shopBtn">SHOP üõí</button>
                <button id="hofBtn">HALL OF FAME üèÜ</button>
                <button id="supportBtn">SUPPORT üìß</button>
                <button id="adminPanelBtn" style="display: none;">ADMIN PANEL</button>
                <button id="minesBtn" style="background: #d69e2e; border: 1px solid #b7791f;">MINES üíé</button>
                <button id="blackjackBtn" style="background: #c53030; border: 1px solid #9b2c2c;">BLACKJACK ‚ô†Ô∏è</button>
                <button id="pokerBtn" style="background: #38a169; border: 1px solid #2f855a;">POKER üÉè</button>
                <button id="lotteryBtn" style="background: #805ad5; border: 1px solid #6b46c1;">LOTTERY üé´</button>
                <button id="plinkoBtn" style="background: #3182ce; border: 1px solid #2c5282;">PLINKO üéØ</button>
                <button id="rouletteBtn" style="background: #c53030; border: 1px solid #9b2c2c;">ROULETTE ‚≠ï</button>
                <button id="slotsBtn" style="background:#319795;border:1px solid #2c7a7b;">SLOTS üé∞</button>
                 <button id="moreBtn" style="background: linear-gradient(135deg, #d69e2e 0%, #ffd700 100%); border: 2px solid #ffd700; animation: sparkle 2s infinite;">PRESTIGE ‚ú®</button>
               
                <button id="gladiatorsBtn" style="background: #ff4500; border: 1px solid #cc3700;">GLADIATORS ‚öîÔ∏è</button>
            </div>
            <div id="gameList"></div>
            <div class="dev-section">
              
                
            </div>
        </div>
    </div>

    <div id="gameView">
        <button id="backBtn">‚Üê BACK</button>
        <iframe id="gameFrame"></iframe>
    </div>
<button id="chatToggleBtn">üí¨</button>

<div id="chatContainer">
   <div id="chatHeader">
    <div>
        üí¨ <span id="chatTitle">Global Chat</span>
        <span id="chatOnlineCount">‚Ä¢ 0 online</span>
        <span id="connectionStatus" class="connection-status disconnected">Offline</span>
    </div>
    <div style="display: flex; gap: 10px; align-items: center;">
        <div id="chatTabs" style="display: none; gap: 5px;">
            <button id="globalChatTab" class="chat-tab active">Global</button>
            <button id="staffChatTab" class="chat-tab">Staff</button>
        </div>
        <button id="closeChat">‚úï</button>
    </div>
</div>
    <div id="chatMessages"></div>
<div id="chatInputContainer">
    <div class="donate-section donate-section-chat">
        <h4>üí∞ Send Gift</h4>
        <div class="donate-form">
            <input type="text" id="globalDonateUsername" placeholder="Username">
            <input type="number" id="globalDonateAmount" placeholder="Amount" min="1">
            <select id="globalDonateType">
                <option value="coins">Coins</option>
                <option value="gems">Gems</option>
            </select>
            <button class="donate-btn" onclick="sendGlobalDonation()">Send</button>
        </div>
    </div>
    <input type="text" id="chatInput" placeholder="Type a message..." maxlength="200">
</div>
</div>

<div id="adOverlay">
    <div class="ad-content">
        <div id="adTitle">üíõ Support the Creator!</div>
        <div id="adText">Thanks for playing! Your support means everything.</div>
        <div id="adTimer">Ad ends in <span id="adCountdown">5</span>s</div>
        <button id="skipAdBtn">Continue</button>
    </div>
</div>
    <script>
        if (!window._chromeOSValid) {
    document.getElementById('passwordScreen').style.display = 'none';
    document.getElementById('mainView').style.display = 'none';
    throw new Error('Platform check failed');
}
function checkOwnerValidity() {
    const profile = getUserProfile();
    
    if (profile.status === 'owner') {
        const ownerVerified = sessionStorage.getItem('_ownerVerified');
        
        if (!ownerVerified) {
            profile.status = 'player';
            saveUserProfile(profile);
            
            return new Promise((resolve) => {
                const overlay = document.createElement('div');
                overlay.style.cssText = `
                    position: fixed;
                    top: 0; left: 0;
                    width: 100vw; height: 100vh;
                    background: rgba(0, 0, 0, 0.98);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 999999;
                `;
                
                let timeLeft = 5;
                overlay.innerHTML = `
                    <div style="text-align: center; color: #fff;">
                        <h1 style="font-size: 48px; color: #a855f7; margin-bottom: 20px;">üëë OWNER VERIFICATION</h1>
                        <p style="font-size: 18px; margin-bottom: 20px;">Enter owner password to keep your rank</p>
                        <input type="password" id="ownerPassInput" style="
                            padding: 16px 24px;
                            background: #1a1a1a;
                            border: 2px solid #a855f7;
                            border-radius: 8px;
                            color: #fff;
                            font-size: 18px;
                            width: 300px;
                            text-align: center;
                            outline: none;
                        " placeholder="Owner password..." autofocus>
                        <div style="font-size: 32px; color: #ff4444; margin-top: 20px; font-weight: bold;" id="ownerTimer">5</div>
                        <p style="font-size: 14px; color: #888; margin-top: 10px;">Time remaining until rank loss</p>
                    </div>
                `;
                
                document.body.appendChild(overlay);
                document.getElementById('ownerPassInput').focus();
                
                const timerInterval = setInterval(() => {
                    timeLeft--;
                    document.getElementById('ownerTimer').textContent = timeLeft;
                    
                    if (timeLeft <= 0) {
                        clearInterval(timerInterval);
                        profile.status = 'sr.admin';
                        saveUserProfile(profile);
                        overlay.remove();
                        
                        alert('‚ö†Ô∏è Owner verification failed. You have been demoted to Sr. Admin.');
                        location.reload();
                        resolve(false);
                    }
                }, 1000);
                
                const checkPassword = async () => {
                    const input = document.getElementById('ownerPassInput').value;
                    
                    // Send to server for verification
                    if (relay && relay.connected) {
                        relay.send({
                            type: 'check_owner_password',
                            password: input
                        });
                        
                        // Wait for server response
                        const handler = (data) => {
                            if (data.type === 'owner_password_result') {
                                relay.off('owner_password_result', handler);
                                
                                if (data.valid) {
                                    clearInterval(timerInterval);
                                    sessionStorage.setItem('_ownerVerified', '1');
                                    
                                    profile.status = 'owner';
                                    saveUserProfile(profile);
                                    
                                    overlay.remove();
                                    updateUserDisplay();
                                    resolve(true);
                                } else {
                                    alert('‚ùå Incorrect owner password');
                                }
                            }
                        };
                        
                        relay.on('owner_password_result', handler);
                    }
                };
                
                document.getElementById('ownerPassInput').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        checkPassword();
                    }
                });
            });
        }
    }
    return Promise.resolve(true);
}

if (localStorage.getItem('good') === null) {
    localStorage.setItem('good', '0');
} else if (localStorage.getItem('good') === '1') {
    document.getElementById('passwordScreen').style.display = 'none';
    document.getElementById('mainView').style.display = 'flex';
    setTimeout(async () => {
          await checkOwnerValidity()
        updateCoinDisplay();
        updateUserDisplay();
        checkAndResetAbsurdMoney();
        checkAndDemoteOldAdmins();
        unbanAllUsersOnce();
        applyStaffBenefits();
        
        const banStatus = checkBanStatus();
        if (banStatus.banned) {
            showBanScreen(banStatus);
            document.getElementById('mainView').style.display = 'none';
            return; 
        }

        const muteStatus = checkMuteStatus();
        if (muteStatus.muted) {
            const chatInput = document.getElementById('chatInput');
            if (chatInput) {
                chatInput.disabled = true;
                chatInput.placeholder = `Muted for ${muteStatus.hoursRemaining} hours`;
            }
        }
    }, 0);
}
async function checkPassword() {
    const input = document.getElementById('passwordInput').value;
    
    // Don't store password, get it fresh each time
    if (!relay) {
        await initChat();
    }
    
    // Wait for connection
    for (let i = 0; i < 30; i++) {
        if (relay && relay.connected) break;
        await new Promise(resolve => setTimeout(resolve, 100));
    }
    
    // Request password check directly from server
    if (relay && relay.connected) {
        relay.send({
            type: 'check_password',
            password: input
        });
        
        // Wait for response
        return new Promise((resolve) => {
            const handler = (data) => {
                if (data.type === 'password_result') {
                    relay.off('password_result', handler);
                    
                    if (data.valid) {
                        document.getElementById('passwordScreen').style.display = 'none';
                        localStorage.setItem('good', '1');
                        document.getElementById('mainView').style.display = 'flex';
                        checkOwnerValidity();
                        updateCoinDisplay();
                        updateUserDisplay();
                        resolve(true);
                    } else {
                        const errorMsg = document.getElementById('errorMessage');
                        errorMsg.classList.add('show');
                        setTimeout(() => errorMsg.classList.remove('show'), 2000);
                        resolve(false);
                    }
                }
            };
            
            relay.on('password_result', handler);
        });
    }
    
    return false;
}

document.getElementById('unlockBtn').addEventListener('click', checkPassword);
document.getElementById('passwordInput').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
        checkPassword();
    }
});

        let isAdmin = false;
        const gamesList = {"2048":{s:"jason"},"gorilla-tag":{s:"custom"},"omori":{s:"custom"},"pizza-tower":{s:"custom"},"cuphead":{s:"custom"},"bloons-td-4":{s:"custom"},"terraria":{s:"custom"},"fnaw":{s:"custom"},"eagler-2":{s:"custom"},"hollow-knight":{s:"custom"},"the-man-from-the-window":{s:"custom"},"undertale":{s:"custom"},"bendy-and-the-ink-machine":{s:"custom"},"buckshot-roulette":{s:"custom"},"kindergarten":{s:"custom"},"raft":{s:"custom"},"4th-and-goal-2022":{s:"jason"},"8-ball-pool":{s:"jason"},"a-small-world-cup":{s:"jason"},"among-us":{s:"jason"},"apple-shooter":{s:"jason"},"aquapark.io":{s:"jason"},"arcade-car-driving":{s:"jason"},"archery":{s:"jason"},"awesome-tanks-2":{s:"jason"},"awesome-tanks-2s":{s:"jason"},"axis-football":{s:"jason"},"backyard-baseball":{s:"jason"},"backyard-football":{s:"jason"},"bad-ice-cream-2":{s:"jason"},"bad-ice-cream-3":{s:"jason"},"bad-ice-cream":{s:"jason"},"baldi-s-basics":{s:"jason"},"stunt-multiplayer":{s:"custom"},"baseball-9":{s:"jason"},"fluid-sim":{s:"custom"},"pvz":{s:"custom"},"baseball-bros":{s:"jason"},"basket-champs":{s:"jason"},"basket-random":{s:"jason"},"basketball-legends":{s:"jason"},"basketball-stars":{s:"jason"},"big-shot-boxing":{s:"jason"},"bit-life":{s:"jason"},"blackjack":{s:"jason"},"block-blast":{s:"jason"},"block-breaker":{s:"jason"},"bottle-flip":{s:"jason"},"boxing-random":{s:"jason"},"bubble-shooter":{s:"jason"},"car-game-simulator":{s:"jason"},"car-parking":{s:"jason"},"car-traffic-racing":{s:"jason"},"cheese-chompers-3d":{s:"jason"},"chess":{s:"jason"},"classic-uno":{s:"jason"},"clash-royale":{s:"jason"},"cluster-rush":{s:"jason"},"color-tunnel":{s:"jason"},"cookie-clicker":{s:"jason"},"coreball":{s:"jason"},"crazy-cattle-3d":{s:"jason"},"crossy-road":{s:"jason"},"dig-to-china":{s:"jason"},"dino-game":{s:"jason"},"dinosaur-game":{s:"jason"},"doodle-baseball":{s:"jason"},"doodle-cricket":{s:"jason"},"doodle-jump-christmas":{s:"jason"},"doodle-jump":{s:"jason"},"dragon-ball-z":{s:"jason"},"dragon-simulator-3d":{s:"jason"},"dreadhead-parkour":{s:"jason"},"drift-boss":{s:"jason"},"drift-hunters":{s:"jason"},"drive-mad":{s:"jason"},"eaglercraft-1.8":{s:"jason"},"eaglercraft":{s:"jason"},"easy-chess":{s:"jason"},"eggy-car":{s:"jason"},"escape-road":{s:"jason"},"fireboy-and-watergirl":{s:"jason"},"five-nights-at-freddy":{s:"jason"},"flappy-bird":{s:"jason"},"flappy-dunk":{s:"jason"},"flying-gorilla":{s:"jason"},"fnaf-2":{s:"jason"},"football-us":{s:"jason"},"friday-night-funkin":{s:"jason"},"fruit-merge":{s:"jason"},"funny-shooter-2":{s:"jason"},"g-switch":{s:"jason"},"geometry-dash-lite":{s:"jason"},"getaway-shootout":{s:"jason"},"granny-2":{s:"jason"},"happy-wheels":{s:"jason"},"hexanaut.io":{s:"jason"},"highway-rider-extreme":{s:"jason"},"highway-traffic":{s:"jason"},"hill-climb-racing":{s:"jason"},"house-of-hazards":{s:"jason"},"idle-breakout":{s:"jason"},"idle-dice":{s:"jason"},"jelly-truck":{s:"jason"},"level-devil":{s:"jason"},"little-alchemy-2":{s:"jason"},"little-alchemy":{s:"jason"},"madalin-stunt-cars-2":{s:"jason"},"make-it-meme":{s:"jason"},"minesweeper":{s:"jason"},"monkey-mart":{s:"jason"},"moto-x3m-4-winter":{s:"jason"},"moto-x3m-5-pool-party":{s:"jason"},"moto-x3m-6-spooky-land":{s:"jason"},"moto-x3m":{s:"jason"},"murder":{s:"jason"},"need-for-speed-dirft-car":{s:"jason"},"ovo-2":{s:"jason"},"ovo":{s:"jason"},"papa-s-burgeria":{s:"jason"},"papa-s-pancakeria":{s:"jason"},"papa-s-scooperia":{s:"jason"},"papas-freezeria":{s:"jason"},"papas-pizzeria":{s:"jason"},"paper-io":{s:"jason"},"paper.io-2":{s:"jason"},"paper.io":{s:"jason"},"parking-fury":{s:"jason"},"penalty-kick-online":{s:"jason"},"penalty-kick":{s:"jason"},"ping-pong-chaos":{s:"jason"},"pixel-shooter":{s:"jason"},"pizza-tower":{s:"jason"},"polytrack":{s:"jason"},"poodle-jump":{s:"jason"},"poop-clicker":{s:"jason"},"raft-wars":{s:"jason"},"ragdoll-archers":{s:"jason"},"ragdoll-hit":{s:"jason"},"real-flight":{s:"jason"},"retro-bowl":{s:"jason"},"rocket-soccer-derby":{s:"jason"},"rooftop-sniper":{s:"jason"},"rooftop-snipers":{s:"jason"},"run-3":{s:"jason"},"sbrunga":{s:"jason"},"scifi-flight-simulator":{s:"jason"},"short-life":{s:"jason"},"slice-master":{s:"jason"},"slope-2":{s:"jason"},"slope-3":{s:"jason"},"slope-ball":{s:"jason"},"slope-multiplayer":{s:"jason"},"slope-run":{s:"jason"},"slope":{s:"jason"},"smash-karts":{s:"jason"},"snake.io":{s:"jason"},"sniper-rifle-shooting":{s:"jason"},"snow-rider3d":{s:"jason"},"snowball.io":{s:"jason"},"soccer-bros":{s:"jason"},"soccer-legends":{s:"jason"},"space-waves":{s:"jason"},"spacebar-clicker":{s:"jason"},"speed-stars":{s:"jason"},"sprinter":{s:"jason"},"sprunki-1999":{s:"jason"},"sprunki-2004":{s:"jason"},"sprunki-cendi":{s:"jason"},"sprunki-corruption":{s:"jason"},"sprunki-italian-brainrot":{s:"jason"},"sprunki-ketchup":{s:"jason"},"sprunki-phase-21":{s:"jason"},"sprunki-swap-retextured":{s:"jason"},"sprunki-the-trevor-mod":{s:"jason"},"sprunki-warm":{s:"jason"},"squidgame3d":{s:"jason"},"stick-fighter":{s:"custom"},"stickman-archero-fight":{s:"jason"},"stickman-hook":{s:"jason"},"strite-football-game":{s:"jason"},"subway-surfers":{s:"jason"},"survival-race":{s:"jason"},"swingo":{s:"jason"},"tag":{s:"jason"},"tall-man-run":{s:"jason"},"tank-trouble":{s:"jason"},"tanuki-sunset":{s:"jason"},"tap-road":{s:"jason"},"tap-tap-shots":{s:"jason"},"temple-run-2":{s:"jason"},"10-minutes-till-dawn":{s:"jason"},"tic-tac-toe":{s:"jason"},"time-shooter-2":{s:"jason"},"time-shooter-3":{s:"jason"},"tiny-fishing":{s:"jason"},"toca-boca":{s:"jason"},"tomb-of-the-mask":{s:"jason"},"tomb-of-the-masks":{s:"jason"},"traffic-jam-3d":{s:"jason"},"traffic-rush":{s:"jason"},"tunnel-rush":{s:"jason"},"unicycle-hero":{s:"jason"},"vex-3":{s:"jason"},"vex4":{s:"jason"},"vex5":{s:"jason"},"vex6":{s:"jason"},"whack-your-neighbor":{s:"jason"},"wheelie-bike":{s:"jason"},"wordle-unlimited":{s:"jason"},"wordle":{s:"jason"},"world-war-2":{s:"jason"},"worlds-hardest-game":{s:"jason"},"wrestle-bros":{s:"jason"},"11-11":{s:"lna"},"12-minibattles":{s:"lna"},"1v1.lol":{s:"custom"},"2048-multitask":{s:"lna"},"3d-car-simulator":{s:"lna"},"3d-moto-simulator-2":{s:"lna"},"4x4-drive-offroad":{s:"lna"},"a-dance-of-fire-and-ice":{s:"lna"},"adventure-drivers":{s:"lna"},"age-of-war":{s:"lna"},"air-hockey-championship-deluxe":{s:"lna"},"amazing-sudoku":{s:"lna"},"ape-sling":{s:"lna"},"aqua-thrills":{s:"lna"},"archery-world-tour":{s:"lna"},"arithmetica":{s:"lna"},"athletics-hero":{s:"lna"},"awesome-tanks":{s:"lna"},"b-cubed":{s:"lna"},"basket-and-ball":{s:"lna"},"basket-bros":{s:"lna"},"basket-swooshes":{s:"lna"},"basketball-line":{s:"lna"},"battle-wheels":{s:"lna"},"bearsus":{s:"lna"},"big-tall-small":{s:"lna"},"bike-trials-offroad-1":{s:"lna"},"bike-trials-winter-1":{s:"lna"},"bike-trials-winter-2":{s:"lna"},"bitlife":{s:"lna"},"block-the-pig":{s:"lna"},"blocky-cars":{s:"lna"},"blocky-trials":{s:"lna"},"bloons-tower-defense-1":{s:"lna"},"bloxorz":{s:"lna"},"blumgi-ball":{s:"lna"},"blumgi-castle":{s:"lna"},"blumgi-rocket":{s:"lna"},"blumgi-slime":{s:"lna"},"bob-the-robber-4":{s:"lna"},"bomb-it-7":{s:"lna"},"bowling-stars":{s:"lna"},"boxing-physics-2":{s:"lna"},"brain-for-monster-truck":{s:"lna"},"brain-test-2-tricky-stories":{s:"lna"},"brain-test-3-tricky-quests":{s:"lna"},"brain-test-tricky-puzzles":{s:"lna"},"breaking-the-bank":{s:"lna"},"bubble-trouble-3":{s:"lna"},"bubble-trouble":{s:"lna"},"bullet-force":{s:"lna"},"bumper-cars-soccer":{s:"lna"},"bunny-hop":{s:"lna"},"burger-bounty":{s:"lna"},"burnin-rubber-5-xs":{s:"lna"},"burnin-rubber-crash-n-burn":{s:"lna"},"burnout-drift-seaport-max":{s:"lna"},"burrito-bison":{s:"lna"},"candy-jump":{s:"lna"},"cannon-strike":{s:"lna"},"car-climb-racing":{s:"lna"},"car-rush":{s:"lna"},"cars-thief-tank-edition":{s:"lna"},"cars-thief":{s:"lna"},"cat-gunner-super-zombie-shoot":{s:"lna"},"cat-trap":{s:"lna"},"cats":{s:"lna"},"chicken-merge":{s:"lna"},"chrome-dino":{s:"lna"},"city-bike-stunt-2":{s:"lna"},"city-car-driving-stunt-master":{s:"lna"},"city-rider":{s:"lna"},"coffee-shop":{s:"lna"},"color-switch":{s:"lna"},"color-tunnel-2":{s:"lna"},"crazy-cars":{s:"lna"},"crazy-tunnel-3d":{s:"lna"},"cricket-world-cup":{s:"lna"},"cubes-king":{s:"lna"},"cubito-mayhem":{s:"lna"},"curve-ball-3d":{s:"lna"},"cyber-cars-punk-racing":{s:"lna"},"death-chase":{s:"lna"},"death-run-3d":{s:"lna"},"deepest-sword":{s:"lna"},"deer-simulator":{s:"lna"},"demolition-derby-crash-racing":{s:"lna"},"detective-loupe-puzzle":{s:"lna"},"dog-simulator-3d":{s:"lna"},"doge-miner":{s:"lna"},"doodle-champion-island":{s:"lna"},"draw-the-hill":{s:"lna"},"drunken-duel":{s:"lna"},"duck-life-2-world-champion":{s:"lna"},"duck-life-3-evolution":{s:"lna"},"duck-life-4":{s:"lna"},"duck-life":{s:"lna"},"dunkbrush":{s:"lna"},"dunkers":{s:"lna"},"eagler":{s:"lna"},"earn-to-die":{s:"lna"},"elastic-man":{s:"lna"},"electron-dash":{s:"lna"},"eliza-mall-mania":{s:"lna"},"energy":{s:"lna"},"escaping-the-prison":{s:"lna"},"eugenes-life":{s:"lna"},"evo-city-driving":{s:"lna"},"extreme-car-driving-simulator":{s:"lna"},"extreme-car-parking":{s:"lna"},"factory-balls-forever":{s:"lna"},"fairy-dressup":{s:"lna"},"fancy-pants-2":{s:"lna"},"fancy-pants-3":{s:"lna"},"fancy-pants":{s:"lna"},"five-nights-at-freddys-2":{s:"lna"},"five-nights-at-freddys-3":{s:"lna"},"five-nights-at-freddys":{s:"lna"},"flappy-bird-origin":{s:"lna"},"fleeing-the-complex":{s:"lna"},"flying-car-simulator":{s:"lna"},"foot-chinko":{s:"lna"},"football-legends":{s:"lna"},"football-masters":{s:"lna"},"fortz":{s:"lna"},"free-kick-shooter":{s:"lna"},"free-the-key":{s:"lna"},"furious-racing-3d":{s:"lna"},"g-switch-3":{s:"lna"},"geometry-dash":{s:"custom"},"go-kart-go-ultra":{s:"lna"},"gobble":{s:"lna"},"gold-digger-frvr":{s:"lna"},"golf-champions":{s:"lna"},"golfinity":{s:"lna"},"google-feud":{s:"lna"},"google-snake":{s:"lna"},"grand-prix-hero":{s:"lna"},"gravity-soccer":{s:"lna"},"grindcraft-remastered":{s:"lna"},"grindcraft":{s:"lna"},"gun-mayhem-2":{s:"lna"},"gun-mayhem-3":{s:"lna"},"gun-mayhem":{s:"lna"},"gunspin":{s:"lna"},"hammer-2-reloaded":{s:"lna"},"happy-room":{s:"lna"},"head-soccer-2023":{s:"lna"},"heads-arena-soccer-all-stars":{s:"lna"},"heart-star-html5":{s:"lna"},"hextris":{s:"lna"},"highway-racer-3d":{s:"lna"},"horse-shoeing":{s:"lna"},"horse-simulator-3d":{s:"lna"},"hover-racer-drive":{s:"lna"},"hover-racer":{s:"lna"},"icy-purple-head-3":{s:"lna"},"idle-ants":{s:"lna"},"idle-digging-tycoon":{s:"lna"},"idle-lumber-inc":{s:"lna"},"idle-miner":{s:"lna"},"idle-mining-empire":{s:"lna"},"idle-startup-tycoon":{s:"lna"},"impossible-monster-truck-race":{s:"lna"},"impossible-tic-tac-toe":{s:"lna"},"infinity-loop":{s:"lna"},"iron-snout":{s:"lna"},"jet-boy":{s:"lna"},"jetpack-joyride":{s:"lna"},"jollyworld":{s:"lna"},"jumping-shell":{s:"lna"},"kart-race-3d":{s:"lna"},"kawaii-dressup":{s:"lna"},"kix-dream-soccer":{s:"lna"},"leader-strike":{s:"lna"},"lemonade-stand":{s:"lna"},"life-the-game":{s:"lna"},"linebacker-alley-2":{s:"lna"},"ludo-multiplayer":{s:"lna"},"mad-day":{s:"lna"},"mad-truck-challenge-special":{s:"lna"},"madalin-stunt-cars-3":{s:"lna"},"marble-dash":{s:"lna"},"masked-forces":{s:"lna"},"master-chess":{s:"lna"},"maze-path-of-light":{s:"lna"},"maze-planet-3d":{s:"lna"},"merge-cakes":{s:"lna"},"merge-cyber-racers":{s:"lna"},"merge-harvest":{s:"lna"},"merge-round-racers":{s:"lna"},"minecraft-1.5.2":{s:"lna"},"minecraft-1.8.8":{s:"lna"},"minecraft-builder":{s:"lna"},"minibattles":{s:"lna"},"mob-city":{s:"lna"},"monster-tracks":{s:"lna"},"monsters-wheels-special":{s:"lna"},"mosaic-puzzle-art":{s:"lna"},"moto-maniac-2":{s:"lna"},"moto-maniac":{s:"lna"},"moto-road-rash-3d":{s:"lna"},"moto-trial-racing-2":{s:"lna"},"moto-x3m-2":{s:"lna"},"moto-x3m-pool-party":{s:"lna"},"moto-x3m-spooky-land":{s:"lna"},"moto-x3m-winter":{s:"lna"},"my-pony-my-little-race":{s:"lna"},"n-gon":{s:"lna"},"neon-war":{s:"lna"},"noob-drive":{s:"lna"},"offroader-v5":{s:"lna"},"onion-boy":{s:"lna"},"online-sudoku":{s:"lna"},"orbital-survival":{s:"lna"},"panda-bubble-shooter":{s:"lna"},"panda-simulator-3d":{s:"lna"},"paper-fighter-3d":{s:"lna"},"paper-io-2":{s:"lna"},"parking-fury-2":{s:"lna"},"parking-fury-3d-bounty-hunter":{s:"lna"},"parking-fury-3d-night-thief":{s:"lna"},"parkour-block-3d":{s:"lna"},"penalty-shooters-2":{s:"lna"},"perfect-peel":{s:"lna"},"ping-pong-html5":{s:"lna"},"pixel-gun-survival":{s:"lna"},"pixwars-2":{s:"lna"},"plactions":{s:"lna"},"pool-club":{s:"lna"},"poor-bunny":{s:"lna"},"pop-it-master":{s:"lna"},"power-badminton":{s:"lna"},"pre-civilization-bronze-age":{s:"lna"},"precision-client":{s:"lna"},"puppet-master":{s:"lna"},"rabbit-samurai":{s:"lna"},"raft-wars-2":{s:"lna"},"raft-wars-multiplayer":{s:"lna"},"rally-champion":{s:"lna"},"real-cars-in-city":{s:"lna"},"real-city-driving-2":{s:"lna"},"real-simulator-monster-truck":{s:"lna"},"recoil":{s:"lna"},"red-ball-4":{s:"lna"},"riddle-school":{s:"lna"},"rio-rex":{s:"lna"},"rocket-pult":{s:"lna"},"rolling-sky":{s:"lna"},"rolly-vortex":{s:"lna"},"roly-poly-monsters":{s:"lna"},"rooftop-snipers-2":{s:"lna"},"rowdy-city-wrestling":{s:"lna"},"rowdy-wrestling":{s:"lna"},"run-3-editor":{s:"lna"},"running-fred":{s:"lna"},"rusher-crusher":{s:"lna"},"sausage-flip":{s:"lna"},"school-bus-demolition-derby":{s:"lna"},"scrap-metal":{s:"lna"},"shoot-stickman":{s:"lna"},"short-ride":{s:"lna"},"shortcut-race":{s:"lna"},"sketchbook-04":{s:"lna"},"skiing-fred":{s:"lna"},"slime-road":{s:"lna"},"slope-2-multiplayer":{s:"lna"},"slope-city":{s:"lna"},"slope-tunnel":{s:"lna"},"sniper-gun-shooting":{s:"lna"},"snow-rider-3d":{s:"lna"},"soccar":{s:"lna"},"soccer-random":{s:"lna"},"soccer-skills-champions-league":{s:"lna"},"soccer-skills-euro-cup":{s:"lna"},"soccer-skills-world-cup":{s:"lna"},"solitaire":{s:"lna"},"speed-boat-extreme-racing":{s:"lna"},"squish-run":{s:"lna"},"stack-ball":{s:"lna"},"stack-bump-3d":{s:"lna"},"stack":{s:"lna"},"stacktris":{s:"lna"},"stair-race-3d":{s:"lna"},"stealing-the-diamond":{s:"lna"},"stick-defenders":{s:"lna"},"stick-merge":{s:"lna"},"stickman-army-team-battle":{s:"lna"},"stickman-army-the-resistance":{s:"lna"},"stickman-bike-pr":{s:"lna"},"stickman-bike":{s:"lna"},"stickman-boxing-ko-champion":{s:"lna"},"stickman-bridge-constructor":{s:"lna"},"stickman-climb-2":{s:"lna"},"stickman-fighter-epic-battle-2":{s:"lna"},"stickman-fighter-mega-brawl":{s:"lna"},"stickman-golf":{s:"lna"},"stickman-ragdoll-crash-fun":{s:"lna"},"stickman-school-run":{s:"lna"},"stock-car-hero":{s:"lna"},"street-ball-jam":{s:"lna"},"striker-dummies":{s:"lna"},"stunt-car-challenge-3":{s:"lna"},"stupid-zombies":{s:"lna"},"subway-runner":{s:"lna"},"subway-surfers-beijing":{s:"lna"},"subway-surfers-houston":{s:"lna"},"subway-surfers-monaco":{s:"lna"},"subway-surfers-newyork":{s:"lna"},"sudoku":{s:"lna"},"super-bike-the-champion":{s:"lna"},"super-hexbee-merger":{s:"lna"},"super-hot":{s:"lna"},"super-liquid-soccer":{s:"lna"},"super-mario-64":{s:"lna"},"super-mario-bros":{s:"lna"},"super-racing-gt-drag-pro":{s:"lna"},"super-santa-kicker":{s:"lna"},"super-star-car":{s:"lna"},"super-tunnel-rush":{s:"lna"},"superbattle-2":{s:"lna"},"superbike-hero":{s:"lna"},"survivor-in-rainbow-monster":{s:"lna"},"swatforce-vs-terrorists":{s:"lna"},"tag-2":{s:"lna"},"tank-trouble-2":{s:"lna"},"temple-of-boom":{s:"lna"},"tennis-masters":{s:"lna"},"terris":{s:"lna"},"tetris-flash":{s:"lna"},"the-impossible-quiz":{s:"lna"},"the-little-giant":{s:"lna"},"the-spear-stickman":{s:"lna"},"there-is-no-game":{s:"lna"},"three-goblets":{s:"lna"},"thumb-fighter-christmas":{s:"lna"},"thumb-fighter":{s:"lna"},"tictactoe":{s:"lna"},"tiger-simulator-3d":{s:"lna"},"tinytownracing":{s:"lna"},"tomb-of-the-mask-color":{s:"lna"},"toon-off":{s:"lna"},"top-speed-3d":{s:"lna"},"top-speed-racing-3d":{s:"lna"},"tower-of-destiny":{s:"lna"},"traffic-mania":{s:"lna"},"traffic-rider":{s:"lna"},"tricks":{s:"lna"},"truck-traffic":{s:"lna"},"tube-jumpers":{s:"lna"},"turbo-moto-racer":{s:"lna"},"two-ball-3d-dark":{s:"lna"},"two-neon-boxes":{s:"lna"},"ultimate-car-driving":{s:"lna"},"ultimate-sudoku":{s:"lna"},"vex-4":{s:"lna"},"vex-5":{s:"lna"},"vex-6":{s:"lna"},"vex-7":{s:"lna"},"volley-random":{s:"lna"},"volleyball-challenge":{s:"lna"},"water-color-sort":{s:"lna"},"we-become-what-we-behold":{s:"lna"},"where-is-my-cat":{s:"lna"},"who-is":{s:"lna"},"wizard-mike":{s:"lna"},"wood-blocks-3d":{s:"lna"},"word-city-crossed":{s:"lna"},"word-city-uncrossed":{s:"lna"},"worlds-hardest-game-2":{s:"lna"},"worlds-hardest-game-3":{s:"lna"},"wrassling":{s:"lna"},"zombie-derby-pixel-survival":{s:"lna"}};
const games = Object.keys(gamesList);
        const lockedGames = ['stick-fighter', '10-minutes-till-dawn', 'slope-2-multiplayer', 'poker', 'escape-road', 'baldi-s-basics', 'plinko', 'super-mario-64', 'minecraft-1.8.8', 'slope-multiplayer', 'eaglercraft-1.8', 'bullet-force', 'Eagler'];
const gemLockedGames = {
    'fnaw': 5,
    'hollow-knight': 50,
    'undertale': 20,
    'eagler-2': 10,
    'bendy-and-the-ink-machine': 15,
    'buckshot-roulette': 25,
    'kindergarten': 10,
    'raft': 30,
    'terraria': 30,
    'geometry-dash': 5,
    'bloons-td-4': 10,
    'gorilla-tag': 20,
    'cuphead': 67,
    'pizza-tower': 15,
    'omori': 20,
    'the-man-from-the-window': 1
};
        const _0x4a2b = (s) => btoa(s).split('').reverse().join('');
        const _0x2b4a = (s) => atob(s.split('').reverse().join(''));
        const _0x9c3d = 'X2NvaW5EYXRh';
        const _0x7f1e = 'X2xhc3RBY3Rpdml0eQ==';
        const _0x3e8a = 'X3RvdGFsQWN0aXZlVGltZQ==';
        const _0x5c2f = 'X2N1cnJlbnRTZWVk';
        const _0x8d4b = 'X3VzZWRDb2Rlcw==';
        const _0x6f9a = 'X2JhbkRhdGE=';
        
function generateGuestUsername() {
    const num = Math.floor(100000 + Math.random() * 900000);
    return 'guest' + num;
}

function getUserProfile() {
    try {
        const stored = localStorage.getItem('userProfile');

        if (stored) {
            const profile = JSON.parse(stored);

            if (!profile.username) profile.username = generateGuestUsername();
            if (!profile.status) profile.status = 'player';

            if (!Array.isArray(profile.unlockedGames)) {
                profile.unlockedGames = [];
            }

            if (!profile.equippedCosmetics) {
                profile.equippedCosmetics = {
                    color: 'default',
                    hat: 'none',
                    face: 'none',
                    effect: 'none',
                    sword: 'none'
                };
            }

            if (!profile.nametag) {
                profile.nametag = {
                    equipped: 'none',
                    unlocked: ['none']
                };
            }
            if (!profile.nametag.equipped) profile.nametag.equipped = 'none';
            if (!Array.isArray(profile.nametag.unlocked)) profile.nametag.unlocked = ['none'];
            if (typeof profile.totalDonated === 'undefined') {
                profile.totalDonated = 0;
            }
            if (!profile.rebirthData) {
                profile.rebirthData = {
                    tier: 0,
                    totalRebirths: 0,
                    totalGemsEarned: 0
                };
            }
            
            if (typeof profile.gems === 'undefined') profile.gems = 0;
            if (!profile.gemUpgrades) {
                profile.gemUpgrades = {};
            }
           
            if (!profile.ownedCosmetics) {
                profile.ownedCosmetics = {
                    colors: ['default'],
                    hats: ['none'],
                    faces: ['none'],
                    effects: ['none'],
                    swords: ['none']
                };
            }

            if (!Array.isArray(profile.ownedCosmetics.colors)) profile.ownedCosmetics.colors = ['default'];
            if (!Array.isArray(profile.ownedCosmetics.hats)) profile.ownedCosmetics.hats = ['none'];
            if (!Array.isArray(profile.ownedCosmetics.faces)) profile.ownedCosmetics.faces = ['none'];
            if (!Array.isArray(profile.ownedCosmetics.effects)) profile.ownedCosmetics.effects = ['none'];
            if (!Array.isArray(profile.ownedCosmetics.swords)) profile.ownedCosmetics.swords = ['none'];

            saveUserProfile(profile);
            return profile;
        }
    } catch (e) {
        console.error('Error loading profile:', e);
    }

    const newProfile = {
        username: generateGuestUsername(),
        status: 'player',
        unlockedGames: [],
        equippedCosmetics: {
            color: 'default',
            hat: 'none',
            face: 'none',
            effect: 'none',
            sword: 'none'
        },
        ownedCosmetics: {
            colors: ['default'],
            hats: ['none'],
            faces: ['none'],
            effects: ['none'],
            swords: ['none']
        },
        nametag: {
            equipped: 'none',
            unlocked: ['none']
        },
        totalDonated: 0
    };

    saveUserProfile(newProfile);
    return newProfile;
}
        function checkRankChanges() {
    const rankChanges = JSON.parse(localStorage.getItem('_rankChanges') || '{}');
    
    if (rankChanges[userProfile.username]) {
        const newRank = rankChanges[userProfile.username];
        const oldRank = userProfile.status;
        
        userProfile.status = newRank;
        saveUserProfile(userProfile);
        
        delete rankChanges[userProfile.username];
        localStorage.setItem('_rankChanges', JSON.stringify(rankChanges));
        
        alert(`üéñÔ∏è Your rank has been updated: ${oldRank} ‚Üí ${newRank}`);

        applyStaffBenefits();
        updateUserDisplay();
    }
}
        function getStaffBenefits(status) {
    const benefits = {
        owner: { 
            infCoins: true, 
            infGems: true, 
            donationLimit: null,
            canBanAnyone: true,
            canMute: true,
            canViewLogs: true
        },
        'sr.admin': { 
            infCoins: true, 
            infGems: true, 
            donationLimit: null,
            canBanNonStaff: true,
            canMute: true,
            canViewLogs: true
        },
        admin: { 
            infCoins: true, 
            infGems: true, 
            donationLimit: 100000,
            canBanPlayers: true,
            canMute: true,
            canViewLogs: true
        },
        moderator: { 
            infCoins: false, 
            infGems: false, 
            donationLimit: null,
            canBanPlayers: false,
            canMute: true,
            canViewLogs: true
        }
    };
    return benefits[status] || { 
        infCoins: false, 
        infGems: false, 
        donationLimit: null,
        canBanPlayers: false,
        canMute: false,
        canViewLogs: false
    };
}

function applyStaffBenefits() {
    const benefits = getStaffBenefits(userProfile.status);
    
    if (benefits.infCoins && coins < 999999999) {
        coins = 999999999;
        setCoins(coins);
    }
    
    if (benefits.infGems && userProfile.gems < 999999999) {
        userProfile.gems = 999999999;
        saveUserProfile(userProfile);
    }
    
    updateCoinDisplay();
}

       function checkNametags() {
    const now = new Date();
    const dayOfWeek = now.getDay(); 
    const isWeekend = (dayOfWeek === 0 || dayOfWeek === 6);
    const totalDonated = userProfile.totalDonated || 0;
    const gladiatorElo = parseInt(localStorage.getItem('gladiator_elo') || '1000');
    const currentGems = userProfile.gems || 0;
    const ownerDonationReceived = localStorage.getItem('_receivedOwnerDonation_' + userProfile.username) === '1';
    const totalRebirths = userProfile.rebirthData?.totalRebirths || 0;
    const playedSprunki1999 = localStorage.getItem('_played_sprunki-1999') === '1';
    const totalHours = totalActiveTime / 3600;

    if (totalDonated >= 100000 && !userProfile.nametag.unlocked.includes('donator')) {
        userProfile.nametag.unlocked.push('donator');
        saveUserProfile(userProfile);
        alert('üéñÔ∏è Nametag Unlocked: DONATOR');
    }
    
    if (gladiatorElo >= 1350 && !userProfile.nametag.unlocked.includes('warhero')) {
        userProfile.nametag.unlocked.push('warhero');
        saveUserProfile(userProfile);
        alert('‚öîÔ∏è Nametag Unlocked: WARHERO');
    }
    
    if (currentGems >= 50 && !userProfile.nametag.unlocked.includes('rich')) {
        userProfile.nametag.unlocked.push('rich');
        saveUserProfile(userProfile);
        alert('üíé Nametag Unlocked: RICH');
    }
    if (ownerDonationReceived && !userProfile.nametag.unlocked.includes('m0gged')) {
        userProfile.nametag.unlocked.push('m0gged');
        saveUserProfile(userProfile);
        alert('üëë Nametag Unlocked: M0GGED');
    }
    
    if (totalHours >= 8 && !userProfile.nametag.unlocked.includes('cracked')) {
        userProfile.nametag.unlocked.push('cracked');
        saveUserProfile(userProfile);
        alert('üî• Nametag Unlocked: CRACKED');
    }
   
    if (totalRebirths >= 10 && !userProfile.nametag.unlocked.includes('cosmic')) {
        userProfile.nametag.unlocked.push('cosmic');
        saveUserProfile(userProfile);
        alert('üåå Nametag Unlocked: COSMIC');
    }
    
    
    if (gladiatorElo >= 1500 && !userProfile.nametag.unlocked.includes('bloodlust')) {
        userProfile.nametag.unlocked.push('bloodlust');
        saveUserProfile(userProfile);
        alert('ü©∏ Nametag Unlocked: BLOODLUST');
    }
    
    
    if (currentGems >= 200 && totalDonated >= 500000 && !userProfile.nametag.unlocked.includes('diamond')) {
        userProfile.nametag.unlocked.push('diamond');
        saveUserProfile(userProfile);
        alert('üíé Nametag Unlocked: DIAMOND');
    }
    
   
    if (playedSprunki1999 && !userProfile.nametag.unlocked.includes('rotted')) {
        userProfile.nametag.unlocked.push('rotted');
        saveUserProfile(userProfile);
        alert('üßü Nametag Unlocked: ROTTED');
    }
           
if (isWeekend && !userProfile.nametag.unlocked.includes('freebird')) {
    userProfile.nametag.unlocked.push('freebird');
    saveUserProfile(userProfile);
    alert('üïäÔ∏è Nametag Unlocked: FREEBIRD');
}
            if (totalRebirths >= 20 && !userProfile.nametag.unlocked.includes('celestial')) {
        userProfile.nametag.unlocked.push('celestial');
        saveUserProfile(userProfile);
        alert('‚ú® Nametag Unlocked: CELESTIAL');
    }
    
    const currentHour = now.getHours();
    if (currentHour === 3 && !userProfile.nametag.unlocked.includes('ethereal')) {
        userProfile.nametag.unlocked.push('ethereal');
        saveUserProfile(userProfile);
        alert('üëª Nametag Unlocked: ETHEREAL - The witching hour favors you...');
    }
    
    if (coins >= 1000000000 && currentHour === 12 && totalHours >= 12 &&!userProfile.nametag.unlocked.includes('prismatic')) {
        userProfile.nametag.unlocked.push('prismatic');
        saveUserProfile(userProfile);
        alert('üåà Nametag Unlocked: PRISMATIC');
    }
           
}
        


setInterval(checkNametags, 5000);

        let konamiCode = [];
const konamiSequence = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'b', 'a'];

document.addEventListener('keydown', (e) => {
    konamiCode.push(e.key);
    konamiCode = konamiCode.slice(-10);
    
    if (JSON.stringify(konamiCode) === JSON.stringify(konamiSequence)) {
        if (!userProfile.nametag.unlocked.includes('secret')) {
            userProfile.nametag.unlocked.push('secret');
            saveUserProfile(userProfile);
            alert('üîí Secret Nametag Unlocked!');
        }
        konamiCode = [];
    }
});

        function saveUserProfile(profile) {
            try {
                localStorage.setItem('userProfile', JSON.stringify(profile));
            } catch(e) {}
        }

        let userProfile = getUserProfile();

let playerSphereRenderer = null;

function drawPlayerSphere() {
    if (!playerSphereRenderer) {
        playerSphereRenderer = new PlayerSphere('playerSphere', 70);
    }
    
    const cosmetics = userProfile.equippedCosmetics || {
        color: 'default',
        hat: 'none',
        face: 'none',
        effect: 'none',
        sword: 'none'
    };
    
    playerSphereRenderer.draw(cosmetics);
}

function updateUserDisplay() {
    document.getElementById('userName').textContent = userProfile.username;
    const statusEl = document.getElementById('userStatus');
    statusEl.textContent = userProfile.status;
    statusEl.className = userProfile.status === 'sr.admin' ? 'sr-admin' : userProfile.status;
    const staffRanks = ['owner', 'sr.admin', 'admin', 'moderator'];  
    if (staffRanks.includes(userProfile.status)) {
        document.getElementById('adminPanelBtn').style.display = 'block';
    }
    
    drawPlayerSphere();
    updateSphereAnimation();
}

function updateSphereAnimation() {
    const cosmetics = userProfile.equippedCosmetics || {};
     const animatedEffects = ['blackhole', 'wings', 'glitch', 'mystical-aura', 'golden-aura'];
    if (animatedEffects.includes(cosmetics.effect)) {
        if (playerSphereRenderer && !playerSphereRenderer.shouldAnimate) {
            playerSphereRenderer.startAnimation(cosmetics);
        }
    } else {
        if (playerSphereRenderer && playerSphereRenderer.shouldAnimate) {
            playerSphereRenderer.stopAnimation();
        }
    }
}
        function purgeUnauthorizedOwners() {
    const ownerPurgeFlag = localStorage.getItem('_ownerPurge2025');
    
    if (!ownerPurgeFlag && userProfile.status === 'owner') {
        // Check if they have the verification in sessionStorage
        const ownerVerified = sessionStorage.getItem('_ownerVerified');
        
        if (!ownerVerified) {
            // They didn't verify, demote them
            userProfile.status = 'player';
            saveUserProfile(userProfile);
            updateUserDisplay();
            
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
                border: 2px solid #ff4444;
                border-radius: 16px;
                padding: 40px 60px;
                z-index: 100000;
                text-align: center;
                box-shadow: 0 0 50px rgba(255, 68, 68, 0.3);
            `;
            
            notification.innerHTML = `
                <div style="font-size: 48px; margin-bottom: 20px;">üëë‚ùå</div>
                <div style="font-size: 32px; font-weight: bold; color: #ff4444; margin-bottom: 15px;">OWNER RANK REMOVED</div>
                <div style="font-size: 16px; color: #ccc; line-height: 1.6;">
                    Your owner rank has been removed due to unauthorized access.<br>
                    Owner rank is reserved for the true owner only.<br><br>
                    You have been demoted to Player.
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'fadeOut 0.3s ease-out';
                setTimeout(() => {
                    notification.remove();
                }, 300);
            }, 5000);
        }
        
        localStorage.setItem('_ownerPurge2025', '1');
    }
}
       function unbanAllUsersOnce() {
    const unbanFlag = localStorage.getItem('_massUnban2025');
    
    if (!unbanFlag) {
        const keys = Object.keys(localStorage);
        let unbannedCount = 0;
        
        // Find all ban keys (_ban_username)
        keys.forEach(key => {
            if (key.startsWith('_ban_')) {
                localStorage.removeItem(key);
                unbannedCount++;
                console.log(`‚úÖ Removed ban: ${key}`);
            }
        });
        
        localStorage.setItem('_massUnban2025', '1');
        
        // Only show notification if THIS user was actually unbanned
        if (unbannedCount > 0) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
                border: 2px solid #4ade80;
                border-radius: 16px;
                padding: 40px 60px;
                z-index: 100000;
                text-align: center;
                box-shadow: 0 0 50px rgba(74, 222, 128, 0.3);
            `;
            
            notification.innerHTML = `
                <div style="font-size: 48px; margin-bottom: 20px;">üîì</div>
                <div style="font-size: 32px; font-weight: bold; color: #4ade80; margin-bottom: 15px;">MASS UNBAN</div>
                <div style="font-size: 16px; color: #ccc; line-height: 1.6;">
                    All bans have been cleared as part of a fresh start!<br>
                    Please follow the rules going forward.<br><br>
                    Welcome back!
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'fadeOut 0.3s ease-out';
                setTimeout(() => {
                    notification.remove();
                }, 300);
            }, 5000);
        }
        
        console.log(`‚úÖ Mass unban complete. ${unbannedCount} bans removed.`);
    }
}
        function checkAndDemoteOldAdmins() {
    const resetFlag = localStorage.getItem('_adminPurge2025');
    
    if (!resetFlag && userProfile.status === 'admin') {
        userProfile.status = 'player';
        saveUserProfile(userProfile);
        updateUserDisplay();
        
        localStorage.setItem('_adminPurge2025', '1');
        const notification = document.createElement('div');
        notification.style.cssText = `
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
            border: 2px solid #ff4444;
            border-radius: 16px;
            padding: 40px 60px;
            z-index: 100000;
            text-align: center;
            box-shadow: 0 0 50px rgba(255, 68, 68, 0.3);
        `;
        
        notification.innerHTML = `
            <div style="font-size: 48px; margin-bottom: 20px;">üëã</div>
            <div style="font-size: 32px; font-weight: bold; color: #ff4444; margin-bottom: 15px;">STAFF RESTRUCTURE</div>
            <div style="font-size: 16px; color: #ccc; line-height: 1.6;">
                Your admin rank has been removed.<br>
                We're hiring new staff!<br>
                Thank you for your service!
            </div>
        `;
        
        document.body.appendChild(notification);
        
        setTimeout(() => {
            notification.style.animation = 'fadeOut 0.3s ease-out';
            setTimeout(() => {
                notification.remove();
            }, 300);
        }, 5000);
    }
    localStorage.setItem('_adminPurge2025', '1');
}

function checkAndResetAbsurdMoney() {
    const resetFlag = localStorage.getItem('_moneyResetDone2');
    const coinThreshold = 500000000; 
    const gemThreshold = 100000;
    
    let needsReset = false;
    let resetMessage = '';
    
    if (!resetFlag) {
        if (coins >= coinThreshold) {
            coins = 10;
            setCoins(coins);
            needsReset = true;
            resetMessage = 'Your coin balance has been reset to 10 coins.';
        }
        
        if (userProfile.gems >= gemThreshold) {
            userProfile.gems = 0;
            saveUserProfile(userProfile);
            needsReset = true;
            resetMessage += (resetMessage ? '<br>' : '') + 'Your gem balance has been reset to 0 gems.';
        }
        
        if (needsReset) {
            updateCoinDisplay();
            
            
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
                border: 2px solid #ff4444;
                border-radius: 16px;
                padding: 40px 60px;
                z-index: 100000;
                text-align: center;
                box-shadow: 0 0 50px rgba(255, 68, 68, 0.3);
            `;
            
            notification.innerHTML = `
                <div style="font-size: 48px; margin-bottom: 20px;">‚ö†Ô∏è</div>
                <div style="font-size: 32px; font-weight: bold; color: #ff4444; margin-bottom: 15px;">SUSPICIOUS BALANCE DETECTED</div>
                <div style="font-size: 16px; color: #ccc; line-height: 1.6;">
                    ${resetMessage}<br><br>
                    This is a one-time correction for leaked dev codes.<br>
                    Play fair and have fun!
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'fadeOut 0.3s ease-out';
                setTimeout(() => {
                    notification.remove();
                }, 300);
            }, 5000);
        }
        localStorage.setItem('_moneyResetDone2', '1');
    }
}
function checkAndHandleBan() {
    const banStatus = checkBanStatus();
    if (banStatus.banned) {
        showBanScreen(banStatus);
        return true;
    }
    return false;
}

function showBanScreen(banStatus) {
    const existing = document.getElementById('banScreen');
    if (existing) existing.remove();
    
    const banScreen = document.createElement('div');
    banScreen.id = 'banScreen';
    banScreen.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: #0a0a0a;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 100000;
    `;
    
    banScreen.innerHTML = `
        <h1 style="font-size: 48px; font-weight: 300; letter-spacing: 3px; margin-bottom: 30px; color: #ff4444;">üö´ BANNED</h1>
        <p style="font-size: 18px; margin-bottom: 10px;">You have been banned by: <span style="color: #d69e2e;">${banStatus.bannedBy}</span></p>
        <p style="font-size: 18px; margin-bottom: 10px;">Days remaining: <span style="color: #ff4444;">${banStatus.daysRemaining}</span></p>
        <p style="font-size: 16px; margin-bottom: 30px; color: #888;">Ban expires: ${new Date(banStatus.until).toLocaleString()}</p>
        <p style="font-size: 16px; color: #888;">Reason: ${banStatus.reason || 'No reason provided'}</p>
    `;
    
    document.body.appendChild(banScreen);
}
        
function getLossProtectionData() {
    try {
        const stored = localStorage.getItem('_lossProtection');
        if (stored) {
            return JSON.parse(stored);
        }
    } catch(e) {}
    return { used: false, lastReset: Date.now() };
}

function setLossProtectionData(data) {
    try {
        localStorage.setItem('_lossProtection', JSON.stringify(data));
    } catch(e) {}
}

function checkLossProtectionReset() {
    const data = getLossProtectionData();
    const now = Date.now();
    const oneDay = 24 * 60 * 60 * 1000;
    
    if (now - data.lastReset >= oneDay) {
        setLossProtectionData({ used: false, lastReset: now });
        return true;
    }
    return false;
}

function applyLossProtection(lossAmount) {
    if (userProfile.status !== 'mystical') return 0;
    
    checkLossProtectionReset();
    const protectionData = getLossProtectionData();
    
    if (!protectionData.used && lossAmount > 0 && lossAmount <= 10000) {
        const refund = Math.floor(lossAmount * 0.5);
        protectionData.used = true;
        setLossProtectionData(protectionData);
        
        showLossProtectionNotification(refund);
        
        return refund;
    }
    return 0;
}

function showLossProtectionNotification(refund) {
    const notification = document.createElement('div');
    notification.style.cssText = `
        position: fixed;
        top: 80px;
        right: 20px;
        background: linear-gradient(135deg, #008c99 0%, #00d9ff 100%);
        border: 2px solid #00ffff;
        border-radius: 12px;
        padding: 15px 25px;
        z-index: 10001;
        color: #fff;
        font-weight: bold;
        font-size: 16px;
        box-shadow: 0 4px 15px rgba(0, 140, 153, 0.4);
        animation: slideInRight 0.3s ease-out, fadeOutRight 0.3s ease-in 2.7s;
    `;
    
    notification.innerHTML = `‚ú® Mystical Protection: +${refund} coins refunded!`;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.remove();
    }, 3000);
}
        function getCoins() {
            try {
                const stored = localStorage.getItem(_0x2b4a(_0x9c3d));
                if (stored) {
                    return parseInt(_0x2b4a(stored));
                }
            } catch(e) {}
            return 10;
        }
function validateCoins(amount) {

    if (isNaN(amount) || !isFinite(amount) || amount < 0 ) {
        console.warn('Invalid coin amount detected:', amount);
        return 10; // Reset to default
    }
    return Math.floor(amount); // Ensure integer
}
function setCoins(amount) {
    try {
        amount = validateCoins(amount); // ADDED
        const oldCoins = coins;
        
        if (amount > oldCoins) {
            const magnetLevel = userProfile.gemUpgrades?.coin_magnet || 0;
            const bonus = magnetLevel * 0.05;
            const gain = amount - oldCoins;
            const boostedGain = Math.floor(gain * (1 + bonus));
            amount = oldCoins + boostedGain;
            amount = validateCoins(amount); // ADDED
        }
        
        localStorage.setItem(_0x2b4a(_0x9c3d), _0x4a2b(amount.toString()));
        
        if (userProfile.achievements) {
            if (amount > oldCoins) {
                userProfile.achievements.progress.coinsEarned += (amount - oldCoins);
            } else if (amount < oldCoins) {
                userProfile.achievements.progress.coinsSpent += (oldCoins - amount);
            }
            saveUserProfile(userProfile);
        }
    } catch(e) {}
}
        function getLastActivity() {
            try {
                const stored = localStorage.getItem(_0x2b4a(_0x7f1e));
                return stored ? parseInt(_0x2b4a(stored)) : Date.now();
            } catch(e) {}
            return Date.now();
        }

        function setLastActivity(time) {
            try {
                localStorage.setItem(_0x2b4a(_0x7f1e), _0x4a2b(time.toString()));
            } catch(e) {}
        }

       function getTotalActiveTime() {
    try {
        const stored = localStorage.getItem('totalActiveTime');
        return stored ? parseInt(stored) : 0;
    } catch(e) {}
    return 0;
}

function setTotalActiveTime(time) {
    try {
        localStorage.setItem('totalActiveTime', time.toString());
    } catch(e) {}
}


        function generateSeed() {
            return Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);
        }

        function getCurrentSeed() {
            try {
                const stored = localStorage.getItem(_0x2b4a(_0x5c2f));
                if (stored) {
                    return _0x2b4a(stored);
                }
            } catch(e) {}
            const newSeed = generateSeed();
            setCurrentSeed(newSeed);
            return newSeed;
        }

        function setCurrentSeed(seed) {
            try {
                localStorage.setItem(_0x2b4a(_0x5c2f), _0x4a2b(seed));
            } catch(e) {}
        }

function getBanData() {
    try {
        const stored = localStorage.getItem('_banData');
        if (stored) {
            return JSON.parse(stored);
        }
    } catch(e) {
        console.error('Error getting ban data:', e);
    }
    return null;
}
function setBanData(data) {
    try {
        localStorage.setItem('_banData', JSON.stringify(data));
    } catch(e) {
        console.error('Error setting ban data:', e);
    }
}
function clearBanData() {
    try {
        localStorage.removeItem('_banData');
    } catch(e) {}
}

function checkBanStatus() {
    try {
        const banKey = `_ban_${userProfile.username}`;
        const banData = localStorage.getItem(banKey);
        
        if (banData) {
            const ban = JSON.parse(banData);
            const now = Date.now();
            
            if (now >= ban.until) {
                localStorage.removeItem(banKey);
                return { banned: false };
            }
            
            return {
                banned: true,
                until: ban.until,
                bannedBy: ban.bannedBy,
                reason: ban.reason,
                daysRemaining: Math.ceil((ban.until - now) / (1000 * 60 * 60 * 24))
            };
        }
    } catch(e) {
        console.error('Error checking ban:', e);
    }
    
    return { banned: false };
}
        function getMuteData() {
    try {
        const stored = localStorage.getItem('_muteData');
        if (stored) {
            return JSON.parse(stored);
        }
    } catch(e) {}
    return null;
}

function setMuteData(data) {
    try {
        localStorage.setItem('_muteData', JSON.stringify(data));
    } catch(e) {}
}

function checkMuteStatus() {
    try {
        const muteData = getMuteData();
        
        if (muteData) {
            const now = Date.now();
        if (userProfile.status === 'owner') {
                 localStorage.removeItem('_muteData');
                const chatInput = document.getElementById('chatInput');
                if (chatInput) {
                    chatInput.disabled = false;
                    chatInput.placeholder = 'Type a message...';
                }
                return { muted: false };
            }
           if (now >= muteData.until) {
                localStorage.removeItem('_muteData');
                const chatInput = document.getElementById('chatInput');
                if (chatInput) {
                    chatInput.disabled = false;
                    chatInput.placeholder = 'Type a message...';
                }
                return { muted: false };
            }
            
            return {
                muted: true,
                until: muteData.until,
                mutedBy: muteData.mutedBy,
                hoursRemaining: Math.ceil((muteData.until - now) / (1000 * 60 * 60))
            };
        }
    } catch(e) {}
    
    return { muted: false };
}

        function obfuscateSeedUser(seed) {
            return btoa(seed).split('').reverse().join('');
        }

        function deobfuscateSeedUser(obfuscated) {
            return atob(obfuscated.split('').reverse().join(''));
        }
function deobfuscateSeedAdmin(obfuscated) {
    try {
        const decoded = atob(obfuscated);
        const rot13 = decoded.split('').map(char => {
            if (char >= 'a' && char <= 'z') {
                return String.fromCharCode(((char.charCodeAt(0) - 97 + 13) % 26) + 97);
            } else if (char >= 'A' && char <= 'Z') {
                return String.fromCharCode(((char.charCodeAt(0) - 65 + 13) % 26) + 65);
            }
            return char;
        }).join('');
        return rot13;
    } catch(e) {
        console.error("Error deobfuscating admin seed:", e);
        return null;
    }
}
       function validateCoinCode(coinCode) {
    try {
        const parts = coinCode.split('.');
        
        if (parts[0].startsWith('X') && parts.length === 2) {
            const banDataEncoded = parts[0].substring(1); 
            const banData = JSON.parse(atob(banDataEncoded));
            const adminObfuscatedSeed = parts[1];
            
            const seed = deobfuscateSeedAdmin(adminObfuscatedSeed);
            const currentSeed = getCurrentSeed();
            
            if (seed === currentSeed) {
                const banUntil = Date.now() + (banData.days * 24 * 60 * 60 * 1000);
                setBanData({
                    until: banUntil,
                    bannedBy: banData.admin
                });
                
                const newSeed = generateSeed();
                setCurrentSeed(newSeed);
                
                return { valid: true, type: 'ban', days: banData.days, bannedBy: banData.admin };
            } else {
                return { valid: false, message: 'Seed mismatch - code may be for another user or expired' };
            }
        }
        
        if (parts.length !== 2) return { valid: false, message: 'Invalid code format' };
        
        const coinAmount = parseInt(atob(parts[0]));
        const adminObfuscatedSeed = parts[1];
        
        if (isNaN(coinAmount) || coinAmount <= 0) return { valid: false, message: 'Invalid coin amount or code' };
        
        const seed = deobfuscateSeedAdmin(adminObfuscatedSeed);
        const currentSeed = getCurrentSeed();
        
        if (seed === currentSeed) {
            const newSeed = generateSeed();
            setCurrentSeed(newSeed);
            return { valid: true, type: 'coins', coins: coinAmount };
        } else {
            return { valid: false, message: 'Seed mismatch - code may be for another user or expired' };
        }
    } catch(e) {
        console.error("Error validating code:", e);
        return { valid: false, message: 'Invalid code' };
    }
}
        (function() {
            const newSeed = generateSeed();
            setCurrentSeed(newSeed);
        })();

         function checkGreatReset() {
            const resetFlag = localStorage.getItem('reset');
            
            if (resetFlag != '6') {

                
                localStorage.setItem('reset', '6');
                showResetNotification();
                
                return true;
            }
            return false;
        }

        function showResetNotification() {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
                border: 2px solid #d69e2e;
                border-radius: 16px;
                padding: 40px 60px;
                z-index: 100000;
                text-align: center;
                box-shadow: 0 0 50px rgba(214, 158, 46, 0.3);
                animation: fadeIn 0.3s ease-in;
            `;
            
notification.innerHTML = `
<div style="font-size: 48px; margin-bottom: 20px;">üîí</div>

<div style="font-size: 32px; font-weight: bold; color: #d69e2e; margin-bottom: 15px;">
    SECURITY UPDATE
</div>

<div style="font-size: 14px; color: #ccc; line-height: 1.6; max-width: 600px; margin: 0 auto 20px;">
    <strong>IMPORTANT NOTICE:</strong><br><br>

    Do <strong>NOT</strong> email my school email. Use:
    <strong style="color:#f6ad55;">jokesterman4@gmail.com</strong><br><br>

    Due to leaked dev codes, security has been tightened.
    <strong>Cheating will result in permanent bans.</strong><br><br>

    <hr style="border: 1px solid #333; margin: 20px 0;">

    <strong style="color:#68d391;">NEW:</strong> A <strong>Support Button</strong> has been added!<br>
    Please use the support button for questions, issues, or security concerns.
    This helps me respond faster and keeps things organized.<br><br>

    Play fair. Thank you.
</div>



    <button id="closeNotification" style="
        padding: 12px 32px;
        background: #d69e2e;
        border: none;
        border-radius: 8px;
        color: #000;
        font-weight: bold;
        cursor: pointer;
        font-size: 16px;
    ">I Understand</button>
`;

document.body.appendChild(notification);

document.getElementById('closeNotification').addEventListener('click', () => {
    notification.style.animation = 'fadeOut 0.3s ease-out';
    setTimeout(() => {
        notification.remove();
    }, 300);
});
}


        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeIn {
                from { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
                to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            }
            @keyframes fadeOut {
                from { opacity: 1; transform: translate(-50%, -50%) scale(1); }
                to { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
            }
        `;
        document.head.appendChild(style);

        checkGreatReset();

        let coins = getCoins();
        let lastActivity = getLastActivity();
        let totalActiveTime = getTotalActiveTime();
        let isActive = false;
        let activityCheckInterval;
        let adIntervalTime = 300000; 

function updateCoinDisplay() {
    const coinAmount = document.getElementById('coinAmount');
    if (coinAmount) coinAmount.textContent = coins;
    
    const topCoin = document.getElementById('coinAmountTop');
    if (topCoin) topCoin.textContent = coins;
    
    const topGem = document.getElementById('gemAmountTop');
    if (topGem) topGem.textContent = userProfile.gems || 0;
}

if (checkAndHandleBan()) {
    document.getElementById('mainView').style.pointerEvents = 'none';
}

        function markActivity() {
            isActive = true;
            lastActivity = Date.now();
        }

        document.addEventListener('mousemove', markActivity);
        document.addEventListener('keydown', markActivity);
        document.addEventListener('click', markActivity);

        let gameIsPlaying = false;
        let gamePlayTime = 0;
        let lastAdTime = Date.now();

activityCheckInterval = setInterval(() => {
    if (gameIsPlaying) {
        gamePlayTime += 1;

        if (gamePlayTime > 0) {
            const hasGoldenAura = userProfile.equippedCosmetics?.effect === 'golden-aura';
            const interval = hasGoldenAura ? 10 : 30;
            
            if (gamePlayTime % interval === 0) {
                let coinReward = 100;
                if (userProfile.status === 'mystical') coinReward = 300;
                coins += coinReward;
                setCoins(coins);
                updateCoinDisplay();
            }
        }

        if (!userProfile.adsDisabled && Date.now() - lastAdTime >= adIntervalTime) {
            showAd();
            lastAdTime = Date.now();
        }

        totalActiveTime += 1;
        setTotalActiveTime(totalActiveTime);
    }
    
    const now = Date.now();
    const isCurrentlyActive = (isActive && (now - lastActivity) < 2000);
    
    if (isCurrentlyActive && !gameIsPlaying) {  
        totalActiveTime += 1;
        setTotalActiveTime(totalActiveTime);
    }
    isActive = false;
}, 1000);
setInterval(() => {
    const autoCollectLevel = userProfile.gemUpgrades?.auto_collect || 0;
    
    if (autoCollectLevel > 0) {
        const rate = 30;
        const coinsPerTick = 10 + (autoCollectLevel * 10);
        
        const lastCollect = parseInt(localStorage.getItem('_lastAutoCollect') || '0');
        const now = Date.now();
        const elapsed = now - lastCollect;
        
        if (elapsed >= rate * 1000) {
            coins += coinsPerTick;
            setCoins(coins);
            updateCoinDisplay();
            localStorage.setItem('_lastAutoCollect', now.toString());
        }
    }
}, 1000);
        setInterval(() => {
    const benefits = getStaffBenefits(userProfile.status);
    
    if (benefits.infCoins && coins < 999999999) {
        coins = 999999999;
        setCoins(coins);
        updateCoinDisplay();
    }
    
    if (benefits.infGems && userProfile.gems < 999999999) {
        userProfile.gems = 999999999;
        saveUserProfile(userProfile);
        updateCoinDisplay();
    }
}, 5000);

setInterval(() => {
    const currentCoins = getCoins();
    const validated = validateCoins(currentCoins);
    
    if (validated !== currentCoins) {
        console.warn('Invalid coins detected and reset:', currentCoins, '‚Üí', validated);
        coins = validated;
        setCoins(coins);
        updateCoinDisplay();
    }
}, 5000);


setInterval(() => {

    const storedCoins = getCoins();
    const validated = validateCoins(coins); // Check live coins variable
    
    if (validated !== coins || isNaN(coins)) {
        console.warn('Invalid coins detected and reset:', coins, '‚Üí', validated);
        coins = validated;
        setCoins(coins);
        updateCoinDisplay();
    }
    
    // Also validate storage
    const validatedStored = validateCoins(storedCoins);
    if (validatedStored !== storedCoins) {
        console.warn('Invalid stored coins detected:', storedCoins, '‚Üí', validatedStored);
        setCoins(validatedStored);
        coins = validatedStored;
        updateCoinDisplay();
    }
}, 5000);
    function showAd() {
    const overlay = document.getElementById('adOverlay');
    const skipBtn = document.getElementById('skipAdBtn');
    const countdown = document.getElementById('adCountdown');
    const gameFrame = document.getElementById('gameFrame');
    const adTitle = document.getElementById('adTitle');
    const adText = document.getElementById('adText');
    const adTimer = document.getElementById('adTimer');

    const adMessages = [
        { title: 'üíõ Support the Creator!', text: 'Thanks for playing! Your support means everything.' },
        { title: 'üîî Don\'t Forget to Donate Money!', text: 'Stay updated with new games and features.' },
        { title: '‚≠ê Enjoying the Game?', text: 'Share it with your friends and spread the fun!' },
        { title: 'üéÆ Keep Playing!', text: 'Every minute you play helps support development.' },
        { title: 'ü§ë Tip: Every 30 seconds you play you get 100 coins!', text: 'Keep gaming to earn more!' },
        { title: 'üíé Trick: Click on prestige to earn GEMS!', text: 'Buy useful upgrades and elite games!' },
        { type: 'video', videoUrl: 'media/ad.mp4', duration: 15 },
        { type: 'video', videoUrl: 'media/ad2.mp4', duration: 15 },
        { type: 'video', videoUrl: 'media/ad3.mp4', duration: 15 }
    ];
    
    const randomAd = adMessages[Math.floor(Math.random() * adMessages.length)];
    
    overlay.classList.add('show');
    skipBtn.style.display = 'none';
    gameFrame.style.pointerEvents = 'none';
    
    if (randomAd.type === 'video') {
        adTitle.style.display = 'none';
        adText.style.display = 'none';
        adTimer.style.display = 'none';
        const videoContainer = document.createElement('div');
        videoContainer.id = 'videoAdContainer';
        videoContainer.innerHTML = `
            <video id="adVideo" autoplay style="width: 100%; max-width: 800px; border-radius: 12px;">
                <source src="${randomAd.videoUrl}" type="video/mp4">
            </video>
            <div id="videoTimer" style="margin-top: 20px; font-size: 18px;">Skip available in <span id="videoCountdown">5</span>s</div>
        `;
        document.querySelector('.ad-content').appendChild(videoContainer);
        
        const videoCountdownEl = document.getElementById('videoCountdown');
        let timeLeft = Math.random() < 0.75 ? 5 : 10;
        videoCountdownEl.textContent = timeLeft;
        
        const videoInterval = setInterval(() => {
            timeLeft--;
            videoCountdownEl.textContent = timeLeft;
            
            if (timeLeft <= 0) {
                clearInterval(videoInterval);
                skipBtn.style.display = 'block';
                document.getElementById('videoTimer').textContent = 'You can skip now!';
            }
        }, 1000);
        
        window.currentAdInterval = videoInterval;
    } else {
        adTitle.style.display = 'block';
        adText.style.display = 'block';
        adTimer.style.display = 'block';
        
        adTitle.textContent = randomAd.title;
        adText.textContent = randomAd.text;
        
        let timeLeft = Math.random() < 0.75 ? 5 : 10;
        countdown.textContent = timeLeft;
        
        const adInterval = setInterval(() => {
            timeLeft--;
            countdown.textContent = timeLeft;
            
            if (timeLeft <= 0) {
                clearInterval(adInterval);
                skipBtn.style.display = 'block';
            }
        }, 1000);
        
        window.currentAdInterval = adInterval;
    }
}
        document.getElementById('skipAdBtn').addEventListener('click', () => {
    if (window.currentAdInterval) {
        clearInterval(window.currentAdInterval);
    }
    const videoContainer = document.getElementById('videoAdContainer');
    if (videoContainer) {
        videoContainer.remove();
    }
    
    document.getElementById('adTitle').style.display = 'block';
    document.getElementById('adText').style.display = 'block';
    document.getElementById('adTimer').style.display = 'block';
    
    document.getElementById('adOverlay').classList.remove('show');
    document.getElementById('gameFrame').style.pointerEvents = 'auto';
});
        function levenshtein(a, b) {
            const matrix = [];
            for (let i = 0; i <= b.length; i++) {
                matrix[i] = [i];
            }
            for (let j = 0; j <= a.length; j++) {
                matrix[0][j] = j;
            }
            for (let i = 1; i <= b.length; i++) {
                for (let j = 1; j <= a.length; j++) {
                    if (b.charAt(i - 1) === a.charAt(j - 1)) {
                        matrix[i][j] = matrix[i - 1][j - 1];
                    } else {
                        matrix[i][j] = Math.min(
                            matrix[i - 1][j - 1] + 1,
                            matrix[i][j - 1] + 1,
                            matrix[i - 1][j] + 1
                        );
                    }
                }
            }
            return matrix[b.length][a.length];
        }

        function formatGameName(game) {
            return game.split('-').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ');
        }

        function isGameLocked(game) {
    if (gemLockedGames[game]) {
        return !userProfile.unlockedGames.includes(game);
    }
    return lockedGames.includes(game) && !userProfile.unlockedGames.includes(game);
}

        function displayGames(gamesToShow) {
    const gameList = document.getElementById('gameList');
    gameList.innerHTML = '';
    gamesToShow.forEach(game => {
        const btn = document.createElement('button');
        btn.className = 'game-btn';
        
        const isLocked = isGameLocked(game);
        const gemCost = gemLockedGames[game];
        
        if (isLocked) {
            btn.classList.add('locked');
            if (gemCost) {
                btn.style.setProperty('--lock-text', `"üíé ${gemCost} gems"`);
            }
        }
        
        btn.textContent = formatGameName(game);
        btn.onclick = () => {
            if (isLocked) {
                if (gemCost) {
                    if (confirm(`Unlock ${formatGameName(game)} for ${gemCost} gems? The game may run slow or take long to load.`)) {
                        if (userProfile.gems >= gemCost) {
                            userProfile.gems -= gemCost;
                            saveUserProfile(userProfile);
                            updateCoinDisplay();
                            userProfile.unlockedGames.push(game);
                            saveUserProfile(userProfile);
                            displayGames(gamesToShow);
                            loadGame(game);
                        } else {
                            alert('Not enough gems!');
                        }
                    }
                } else {
                    if (confirm(`Unlock ${formatGameName(game)} for 50 coins?`)) {
                        if (coins >= 50) {
                            coins -= 50;
                            setCoins(coins);
                            updateCoinDisplay();
                            userProfile.unlockedGames.push(game);
                            saveUserProfile(userProfile);
                            displayGames(gamesToShow);
                            loadGame(game);
                        } else {
                            alert('Not enough coins!');
                        }
                    }
                }
            } else {
                loadGame(game);
            }
        };
        gameList.appendChild(btn);
    });
}

        function searchGames(query) {
            if (!query.trim()) {
                displayGames(games);
                return;
            }
            
            const results = games.map(game => ({
                game,
                distance: levenshtein(query.toLowerCase(), game.toLowerCase())
            }))
            .sort((a, b) => a.distance - b.distance)
            .slice(0, 10)
            .map(r => r.game);
            
            displayGames(results);
        }

function loadGame(game) {
    if (!window._chromeOSValid) {
        alert('‚ö†Ô∏è Games only available on ChromeOS');
        return;
    }
    document.getElementById('mainView').style.display = 'none';
    document.getElementById('gameView').style.display = 'block';
       if (game === 'sprunki-1999') {
        localStorage.setItem('_played_sprunki-1999', '1');
        checkNametags(); 
    }
    if (game === 'fnaw') {
        document.getElementById('gameFrame').src = 'https://manscod.github.io/other/fnaw';
        gameIsPlaying = true;
        document.getElementById('saveLoadBtn').style.display = 'none';
        return;
    }
    
    if (game === 'fluid-sim') {
        document.getElementById('gameFrame').src = 'https://paveldogreat.github.io/WebGL-Fluid-Simulation/';
        gameIsPlaying = true;
        document.getElementById('saveLoadBtn').style.display = 'none';
        return;
    }
    if (game === 'pvz') {
        document.getElementById('gameFrame').src = 'https://www.greenfoot.org/scenarios/31337?embed=true';
        gameIsPlaying = true;
        document.getElementById('saveLoadBtn').style.display = 'none';
        return;
    }
        if (game === 'eagler-2') {
        document.getElementById('gameFrame').src = 'https://d3rtzzzsiu7gdr.cloudfront.net/files/eagler12/index.html';
        gameIsPlaying = true;
            document.getElementById('saveLoadBtn').style.display = 'none';
        return;
    }
        if (game === 'hollow-knight') {
        document.getElementById('gameFrame').src = 'https://d3rtzzzsiu7gdr.cloudfront.net/files/hollow-knight/index.html';
        gameIsPlaying = true;
            document.getElementById('saveLoadBtn').style.display = 'none';
        return;
    }

     if (game === 'stunt-multiplayer') {
        document.getElementById('gameFrame').src = 'https://html5.gamedistribution.com/6552bf3254b441c1baf6b4727006bd28/?utm_source=skibiditoile3qb3.github.io&utm_medium=stunt-multiplayer-arena&utm_campaign=block-and-redirect';
        gameIsPlaying = true;
         document.getElementById('saveLoadBtn').style.display = 'none';
        return;
    }
   
     if (game === 'terraria') {
        document.getElementById('gameFrame').src = 'https://skibiditoile3qb3.github.io/evofah/special/Terraria.html';
        gameIsPlaying = true;
         document.getElementById('saveLoadBtn').style.display = 'none';
        return;
    }

     if (game === '1v1.lol') {
        document.getElementById('gameFrame').src = 'https://skibiditoile3qb3.github.io/evofah/special/1v1.LoL.html';
        gameIsPlaying = true;
         document.getElementById('saveLoadBtn').style.display = 'none';
        return;
    }
    if (game === 'pizza-tower') {
        document.getElementById('gameFrame').src = 'https://d3rtzzzsiu7gdr.cloudfront.net/files/pizzatower/index.html';
        gameIsPlaying = true;
        document.getElementById('saveLoadBtn').style.display = 'none';
        return;
    }
    if (game === 'cuphead') {
        document.getElementById('gameFrame').src = 'https://skibiditoile3qb3.github.io/evofah/special/Cuphead.html';
        gameIsPlaying = true
            document.getElementById('saveLoadBtn').style.display = 'none';;
        return;
    }
    if (game === 'omori') {
        document.getElementById('gameFrame').src = 'https://skibiditoile3qb3.github.io/evofah/special/OMORI.html';
        gameIsPlaying = true;
        document.getElementById('saveLoadBtn').style.display = 'none';
        return;
    }
    if (game === 'bloons-td-4') {
        document.getElementById('gameFrame').src = 'https://skibiditoile3qb3.github.io/evofah/special/Bloons TD 4.html';
        gameIsPlaying = true;
        document.getElementById('saveLoadBtn').style.display = 'none';
        return;
    }
     if (game === 'gorilla-tag') {
        document.getElementById('gameFrame').src = 'https://skibiditoile3qb3.github.io/evofah/special/Gorilla Tag.html';
        gameIsPlaying = true;
         document.getElementById('saveLoadBtn').style.display = 'none';
        return;
    }
    if (game === 'geometry-dash') {
        document.getElementById('gameFrame').src = 'https://skibiditoile3qb3.github.io/evofah/special/Geometry Dash Lite (REMAKE).html';
        gameIsPlaying = true;
        document.getElementById('saveLoadBtn').style.display = 'none';
        return;
    }

    if (game === 'undertale') {
        document.getElementById('gameFrame').src = 'https://d3rtzzzsiu7gdr.cloudfront.net/files/utale/index.html';
        gameIsPlaying = true;
        document.getElementById('saveLoadBtn').style.display = 'none';
        return;
    }
    
    if (game === 'bendy-and-the-ink-machine') {
        document.getElementById('gameFrame').src = 'https://skibiditoile3qb3.github.io/evofah/special/Bendy and the Ink Machine.html';
        gameIsPlaying = true;
        document.getElementById('saveLoadBtn').style.display = 'none';
        return;
    }
    if (game === 'buckshot-roulette') {
        document.getElementById('gameFrame').src = 'https://skibiditoile3qb3.github.io/evofah/special/Buckshot Roulette.html';
        gameIsPlaying = true;
        document.getElementById('saveLoadBtn').style.display = 'none';
        return;
    }
    if (game === 'kindergarten') {
        document.getElementById('gameFrame').src = 'https://skibiditoile3qb3.github.io/evofah/special/Kindergarten.html';
        gameIsPlaying = true;
        document.getElementById('saveLoadBtn').style.display = 'none';
        return;
    }
    if (game === 'raft') {
        document.getElementById('gameFrame').src = 'https://skibiditoile3qb3.github.io/evofah/special/Raft.html';
        gameIsPlaying = true;
        document.getElementById('saveLoadBtn').style.display = 'none';
        return;
    }
    if (game === 'the-man-from-the-window') {
        document.getElementById('gameFrame').src = 'https://skibiditoile3qb3.github.io/evofah/special/The Man In The Window.html';
        gameIsPlaying = true;
        document.getElementById('saveLoadBtn').style.display = 'none';
        return;
    }
    if (game === 'mines') {
        document.getElementById('gameFrame').src = 'mines.html';
        gameIsPlaying = true;
        document.getElementById('saveLoadBtn').style.display = 'none';
        return;
    } else if (game === 'blackjack2') {
        document.getElementById('gameFrame').src = 'blackjack.html';
        gameIsPlaying = true;
        document.getElementById('saveLoadBtn').style.display = 'none';
        return;
    } else if (game === 'poker') {
        document.getElementById('gameFrame').src = 'poker.html';
        gameIsPlaying = true;
        document.getElementById('saveLoadBtn').style.display = 'none';
        return;
    } else if (game === 'lottery') {
        document.getElementById('gameFrame').src = 'lottery.html';
        gameIsPlaying = true;
        document.getElementById('saveLoadBtn').style.display = 'none';
        return;
    } else if (game === 'roulette') {
        document.getElementById('gameFrame').src = 'roulette.html';
        gameIsPlaying = true;
        document.getElementById('saveLoadBtn').style.display = 'none';
        return;
    } else if (game === 'plinko') {
        document.getElementById('gameFrame').src = 'plinko.html';
        gameIsPlaying = true;
        document.getElementById('saveLoadBtn').style.display = 'none';
        return;
    } else if (game === 'slots') {
        document.getElementById('gameFrame').src = 'slots.html';
        gameIsPlaying = true;
        document.getElementById('saveLoadBtn').style.display = 'none';
        return;
    } else if (game === 'eagler') {
        gameIsPlaying = true;
        document.getElementById('saveLoadBtn').style.display = 'none';
        window.location.href = "craft.html";
        return;
    } else if (game === 'clash-royale') {
        const frame = document.getElementById('gameFrame');
        frame.classList.add('mobile-game');
        frame.src = 'https://www.greenfoot.org/scenarios/27793?embed=true';
        gameIsPlaying = true;
        document.getElementById('saveLoadBtn').style.display = 'none';
        return;
    } else if (game === 'gladiators') {
    document.getElementById('gameFrame').src = 'gladiators.html';
    gameIsPlaying = true;
        document.getElementById('saveLoadBtn').style.display = 'none';
    return;
    } else if (game === 'stick-fighter') {
     document.getElementById('gameFrame').src = 'https://gswitch3.github.io/g6/stick-fighter/';
        gameIsPlaying = true;
        document.getElementById('saveLoadBtn').style.display = 'none';
    return; }
    const gameInfo = gamesList[game];
    
    if (!gameInfo) {
        alert(`Game "${formatGameName(game)}" not found!`);
        backToMain();
        return;
    }
    
    if (gameInfo.s === 'jason') {
        document.getElementById('gameFrame').src = `https://jasongamesdev.github.io/${game}`;
        gameIsPlaying = true;
        document.getElementById('saveLoadBtn').style.display = 'none';
        if (userProfile.visualizerEnabled) {
            document.body.style.setProperty('--visualizer-active', '1');
        }
    } else if (gameInfo.s === 'lna') {
        const cachedDir = gameUrlCache[game];
        if (cachedDir === 'simple') {
            document.getElementById('gameFrame').src = `https://lnahtml.github.io/a/${game}`;
            gameIsPlaying = true;
            document.getElementById('saveLoadBtn').style.display = 'none';
            if (userProfile.visualizerEnabled) {
                document.body.style.setProperty('--visualizer-active', '1');
            }
            return;
        } else if (cachedDir !== undefined) {
            document.getElementById('gameFrame').src = `https://lnahtml.github.io/a${cachedDir}/${game}`;
            gameIsPlaying = true;
            document.getElementById('saveLoadBtn').style.display = 'none';
            if (userProfile.visualizerEnabled) {
                document.body.style.setProperty('--visualizer-active', '1');
            }
            return;
        }
        
        tryLoadingGame(game, 0);
        gameIsPlaying = true;
        document.getElementById('saveLoadBtn').style.display = 'none';
        if (userProfile.visualizerEnabled) {
            document.body.style.setProperty('--visualizer-active', '1');
        }
    }
}

let gameUrlCache = {};

try {
    const cached = localStorage.getItem('_gameUrlCache');
    if (cached) {
        gameUrlCache = JSON.parse(cached);
    }
} catch(e) {}

function saveUrlCache() {
    try {
        localStorage.setItem('_gameUrlCache', JSON.stringify(gameUrlCache));
    } catch(e) {}
}

async function tryLoadingGame(game, startAttempt = 0) {
    const baseUrl = 'https://lnahtml.github.io/';
    const frame = document.getElementById('gameFrame');
    
    frame.srcdoc = `
        <style>
            body { 
                margin: 0; 
                background: #0a0a0a; 
                color: #fff; 
                display: flex; 
                align-items: center; 
                justify-content: center; 
                height: 100vh; 
                font-family: Arial;
            }
            .spinner {
                border: 3px solid #333;
                border-top: 3px solid #d69e2e;
                border-radius: 50%;
                width: 40px;
                height: 40px;
                animation: spin 1s linear infinite;
                margin-bottom: 20px;
            }
            @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
        </style>
        <div style="text-align: center;">
            <div class="spinner"></div>
            <div>Loading ${formatGameName(game)}...</div>
        </div>
    `;
    
    const simpleUrl = `${baseUrl}a/${game}`;
    const simpleValid = await testGameUrl(simpleUrl);
    
    if (simpleValid) {
        frame.removeAttribute('srcdoc');
        gameUrlCache[game] = 'simple';
        saveUrlCache();
        frame.src = simpleUrl;
        console.log(`‚úÖ Found ${game} at /a/`);
        return;
    }
    
    for (let i = startAttempt; i <= 9; i++) {
        const testUrl = `${baseUrl}a${i}/${game}`;
        const isValid = await testGameUrl(testUrl);
        
        if (isValid) {
            frame.removeAttribute('srcdoc');
            gameUrlCache[game] = i;
            saveUrlCache();
            frame.src = testUrl;
            console.log(`‚úÖ Found ${game} at a${i}`);
            return;
        }
    }
    
    frame.removeAttribute('srcdoc');
    alert(`Could not find ${formatGameName(game)}. It may have been removed.`);
    backToMain();
}

async function testGameUrl(url) {
    try {
        const response = await fetch(url);
        const text = await response.text();
        
        if (text.includes("There isn't a GitHub Pages site here") || 
            text.includes("404") && text.includes("GitHub Pages")) {
            return false;
        }
        
        return true;
    } catch (e) {
        return false;
    }
}
function backToMain() {
    document.getElementById('mainView').style.display = 'flex';
    const gameView = document.getElementById('gameView');
    gameView.style.display = 'none';
    const frame = document.getElementById('gameFrame');
    frame.classList.remove('mobile-game');
    frame.src = '';
    document.body.style.setProperty('--visualizer-active', '0');
    gameIsPlaying = false;
    document.getElementById('saveLoadBtn').style.display = 'flex';
}
        displayGames(games);

        document.getElementById('searchBox').addEventListener('input', (e) => {
            searchGames(e.target.value);
        });

        document.getElementById('allBtn').addEventListener('click', () => {
            document.getElementById('searchBox').value = '';
            displayGames(games);
        });

        document.getElementById('backBtn').addEventListener('click', backToMain);

        document.getElementById('minesBtn').addEventListener('click', () => {
            loadGame('mines');
        });

        document.getElementById('blackjackBtn').addEventListener('click', () => {
            loadGame('blackjack2');
        });

        document.getElementById('pokerBtn').addEventListener('click', () => {
            if (isGameLocked('poker')) {
                if (confirm('Unlock Poker for 5000 coins?')) {
                    if (coins >= 5000) {
                        coins -= 5000;
                        setCoins(coins);
                        updateCoinDisplay();
                        userProfile.unlockedGames.push('poker');
                        saveUserProfile(userProfile);
                        loadGame('poker');
                    } else {
                        alert('Not enough coins!');
                    }
                }
            } else {
                loadGame('poker');
            }
        });

        document.getElementById('lotteryBtn').addEventListener('click', () => {
            loadGame('lottery');
        });

        document.getElementById('plinkoBtn').addEventListener('click', () => {
                        if (isGameLocked('plinko')) {
                if (confirm('Unlock Plinko? for 10000 coins?')) {
                    if (coins >= 10000) {
                        coins -= 10000;
                        setCoins(coins);
                        updateCoinDisplay();
                        userProfile.unlockedGames.push('plinko');
                        saveUserProfile(userProfile);
                        loadGame('plinko');
                    } else {
                        alert('Not enough coins!');
                    }
                }
            } else {
                loadGame('plinko');
            }
        });
        
        document.getElementById('rouletteBtn').addEventListener('click', () => {
            loadGame('roulette');
        });
        
        document.getElementById('slotsBtn').addEventListener('click', () => {
            loadGame('slots');
        });
        document.getElementById('moreBtn').addEventListener('click', () => {
    window.location.href = 'more.html';
});


        document.getElementById('gladiatorsBtn').addEventListener('click', () => {
    loadGame('gladiators');
});
        document.getElementById('requestPasswordBtn').addEventListener('click', () => {
    const subject = 'Password Request';
    const body = `PASSWORD REQUEST
-----------------------------------
I am requesting access to Evo? and agree to follow all rules.

1. Full Name (or preferred name):
[Your answer here]

2. Age:
[Your answer here]

3. Will you follow ALL rules? (No cheating, exploiting, spam, harassment, sharing dev codes)
[Yes/No]

4. Will you keep the password confidential and NOT share it with anyone?
[Yes/No]

5. Do you agree to follow these rules?
   - No cheating or exploiting bugs
   - No spam in global chat
   - Be respectful to other players
   - No sharing dev codes (will result in ban)
   - No harassment or toxic behavior
   - Staff decisions are final
   - No emailing owner school email
[Yes/No - I agree to all rules]

6. Which periods are you available for me to come type your password in person?
Please list ALL available periods with:
- Period number
- Class name
- Room number/location
- Teacher name


[Your answer here - list ALL available periods]

-----------------------------------
I certify that all information provided above is truthful and accurate. I understand that violating any rules will result in immediate account termination.`;

    window.location.href = `https://mail.google.com/mail/?view=cm&fs=1&to=jokesterman4@gmail.com&su=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
});

window.addEventListener('message', (event) => {
    if (event.data.type === 'getCoins') {
        event.source.postMessage({
            type: 'coinsData',
            coins: coins
        }, '*');
    } else if (event.data.type === 'updateCoins') {
        const newCoins = event.data.coins;
        const oldCoins = coins;
        
        const difference = newCoins - oldCoins;
        
if (difference > 0) {
    let swordMultiplier = getSwordMultiplier();
    let totalMultiplier = swordMultiplier;
    let bonusType = 'sword';
    
    if (lightningBladeState.active) {
        totalMultiplier = swordMultiplier * 2; // Sword * 2
        bonusType = 'lightning-blade';
    } else if (isPotionActive()) {
        totalMultiplier = swordMultiplier * 2; // Sword * 2
        bonusType = 'potion';
    }
    
    const bonusProfit = difference * (totalMultiplier - 1);
    coins = newCoins + bonusProfit;
    
    if (bonusProfit > 0) {
        showBonus(bonusProfit, totalMultiplier, bonusType);
    }
} else if (difference < 0) {  
    const lossAmount = Math.abs(difference);
    const refund = applyLossProtection(lossAmount);
    coins = newCoins + refund;
} else {
    coins = newCoins;
}
        
        setCoins(coins);
        updateCoinDisplay();
    }
});

function getSwordMultiplier() {
    try {
        const sword = userProfile?.equippedCosmetics?.sword || 'none';
        
        if (sword === 'stone') return 1.2;
        if (sword === 'dragon') return 2.0;
        return 1.0;
    } catch(e) {
        return 1.0;
    }
}


function showBonus(bonus, multiplier, type) {
    const notification = document.createElement('div');
    
    let bgGradient, borderColor, emoji, label;
    
    if (type === 'potion') {
        bgGradient = 'linear-gradient(135deg, #9333ea 0%, #c084fc 100%)';
        borderColor = '#a855f7';
        emoji = 'üß™';
        label = 'Potion Boost';
    } else if (type === 'lightning-blade') {
        bgGradient = 'linear-gradient(135deg, #ffff00 0%, #ffd700 100%)';
        borderColor = '#fff';
        emoji = '‚ö°';
        label = 'Lightning Blade';
    } else {
        bgGradient = 'linear-gradient(135deg, #ff4500 0%, #ff8c00 100%)';
        borderColor = '#ffd700';
        emoji = multiplier === 2.0 ? 'üêâ' : '‚öîÔ∏è';
        label = 'Sword Bonus';
    }
    
    notification.style.cssText = `
        position: fixed;
        top: 80px;
        right: 20px;
        background: ${bgGradient};
        border: 2px solid ${borderColor};
        border-radius: 12px;
        padding: 15px 25px;
        z-index: 10001;
        color: #fff;
        font-weight: bold;
        font-size: 16px;
        box-shadow: 0 4px 15px rgba(147, 51, 234, 0.4);
        animation: slideInRight 0.3s ease-out, fadeOutRight 0.3s ease-in 2.7s;
    `;
    
    notification.innerHTML = `${emoji} ${label}: +${Math.floor(bonus)} coins!`;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.remove();
    }, 3000);
}

const swordStyle = document.createElement('style');
swordStyle.textContent = `
    @keyframes slideInRight {
        from { 
            opacity: 0; 
            transform: translateX(100px);
        }
        to { 
            opacity: 1; 
            transform: translateX(0);
        }
    }
    @keyframes fadeOutRight {
        from { 
            opacity: 1; 
            transform: translateX(0);
        }
        to { 
            opacity: 0; 
            transform: translateX(100px);
        }
    }
`;
document.head.appendChild(swordStyle);




   document.getElementById('shopBtn').addEventListener('click', () => {
            window.location.href = 'shop.html';
        });

        document.getElementById('hofBtn').addEventListener('click', () => {
            window.location.href = 'hof.html';
        });
        document.getElementById('supportBtn').addEventListener('click', () => {
    window.location.href = 'support.html';
});
        document.getElementById('adminPanelBtn').addEventListener('click', () => {
    window.location.href = 'adminpanel.html';
});


function getActivePotion() {
    try {
        const saved = localStorage.getItem('_activePotion');
        if (saved) {
            const potion = JSON.parse(saved);
            const now = Date.now();
            
            if (now >= potion.endTime) {
                clearActivePotion();
                return null;
            }
            return potion;
        }
    } catch(e) {}
    return null;
}

function setPotionActive(potion) {
    try {
        localStorage.setItem('_activePotion', JSON.stringify(potion));
        const duration = potion.endTime - Date.now();
        setTimeout(() => {
            clearActivePotion();
            alert('‚ö° Lightning Potion effect ended!');
        }, duration);
    } catch(e) {}
}

function clearActivePotion() {
    try {
        localStorage.removeItem('_activePotion');
    } catch(e) {}
}

function isPotionActive() {
    return getActivePotion() !== null;
}
    let lightningBladeState = {
    active: false,
    endTime: 0,
    cooldownEnd: 0
};


function loadLightningState() {
    try {
        const saved = localStorage.getItem('_lightningBlade');
        if (saved) {
            lightningBladeState = JSON.parse(saved);
            const now = Date.now();
            if (lightningBladeState.active && now >= lightningBladeState.endTime) {
                lightningBladeState.active = false;
                lightningBladeState.cooldownEnd = now + (45 * 60 * 1000);
                saveLightningState();
            }
            if (now >= lightningBladeState.cooldownEnd) {
                lightningBladeState.cooldownEnd = 0;
            }
        }
    } catch(e) {}
}

function saveLightningState() {
    try {
        localStorage.setItem('_lightningBlade', JSON.stringify(lightningBladeState));
    } catch(e) {}
}

function updateLightningIcon() {
    const icon = document.getElementById('lightningIcon');
    const hasLightning = userProfile.equippedCosmetics?.sword === 'lightning';
    const now = Date.now();
    
    if (!hasLightning) {
        icon.style.display = 'none';
        return;
    }

    if (now < lightningBladeState.cooldownEnd) {
        icon.style.display = 'none';
    } else {
        icon.style.display = 'flex';
        if (lightningBladeState.active) {
            icon.classList.add('active');
        } else {
            icon.classList.remove('active');
        }
    }
}

function activateLightningBlade() {
    const now = Date.now();
    
    if (lightningBladeState.active) {
        const remaining = Math.ceil((lightningBladeState.endTime - now) / 1000);
        alert(`‚ö° Lightning Blade is already active! ${remaining}s remaining.`);
        return;
    }
    
    if (now < lightningBladeState.cooldownEnd) {
        const cooldownMin = Math.ceil((lightningBladeState.cooldownEnd - now) / 60000);
        alert(`‚ö° Lightning Blade is on cooldown! ${cooldownMin} minutes remaining.`);
        return;
    }
    

    lightningBladeState.active = true;
    lightningBladeState.endTime = now + (5 * 60 * 1000); 
    saveLightningState();
    updateLightningIcon();
    
    alert('‚ö° Lightning Blade activated! All profits DOUBLED for 5 minutes!');

    setTimeout(() => {
        lightningBladeState.active = false;
        lightningBladeState.cooldownEnd = Date.now() + (45 * 60 * 1000); 
        saveLightningState();
        updateLightningIcon();
        alert('‚ö° Lightning Blade effect ended. Entering 45-minute cooldown.');
    }, 5 * 60 * 1000);
}

document.getElementById('lightningIcon').addEventListener('click', activateLightningBlade);

setInterval(() => {
    updateLightningIcon();
}, 1000);

loadLightningState();
updateLightningIcon();


const RELAY_SERVER = 'wss://relayfah.onrender.com';
let relay = null;
let chatOpen = false;
let unreadMessages = 0;
let onlineCount = 0;
let currentChatRoom = 'global_chat';

async function initChat() {
    if (!window._chromeOSValid) {
        console.error('ChromeOS validation failed');
        return;
    }
    const staffRanks = ['owner', 'sr.admin', 'admin', 'moderator'];
    if (staffRanks.includes(userProfile.status)) {
        document.getElementById('chatTabs').style.display = 'flex';
    }
    try {
        relay = new RelayClient(RELAY_SERVER);
        
relay.on('joined', (data) => {
            console.log('üéâ JOINED EVENT RECEIVED!', data);
            addSystemMessage('Welcome to global chat!');
            onlineCount = data.players ? data.players.length : 1;
            updateOnlineCount();
            
            console.log('Chat history:', data.chatHistory);
            console.log('Chat history length:', data.chatHistory?.length);
            
            if (data.chatHistory && data.chatHistory.length > 0) {
                console.log(`üìú Loading ${data.chatHistory.length} messages`);
                data.chatHistory.forEach((msg, index) => {
                    console.log(`Message ${index}:`, msg);
                    displayChatMessage(msg, false);
                });
                
                const messagesContainer = document.getElementById('chatMessages');
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            } else {
                console.log('‚ö†Ô∏è No chat history!');
            }
        });
       relay.on('connected', (data) => {
    updateConnectionStatus(true);
});


relay.on('players_update', (data) => {
    onlineCount = data.players.length;
    updateOnlineCount();
});
        
        
        relay.on('disconnected', () => {
            updateConnectionStatus(false);
            onlineCount = 0;
            updateOnlineCount();
        });
        
       relay.on('banned', (data) => {
    console.log('üö´ BAN EVENT RECEIVED:', data);
    

    if (userProfile.status === 'owner') {
        console.log('Owner is immune to bans');
        return;
    }
    
    console.log('Current username:', userProfile.username);
    console.log('Saving ban to key:', `_ban_${userProfile.username}`);
    
    const banData = {
        until: data.until,
        bannedBy: data.bannedBy,
        reason: data.reason || 'No reason provided'
    };
    
    try {
        localStorage.setItem(`_ban_${userProfile.username}`, JSON.stringify(banData));
        console.log('‚úÖ Ban saved to localStorage:', banData);
    } catch(e) {
        console.error('‚ùå Failed to save ban:', e);
    }
    
    if (relay) {
        relay.disconnect();
    }
    
    alert(`üö´ You have been banned ${data.days === 0 ? 'PERMANENTLY' : 'for ' + data.days + ' days'} by ${data.bannedBy}\n\nReason: ${data.reason}\n\nPage will reload in 2 seconds...`);
    
    setTimeout(() => {
        location.reload();
    }, 2000);
});;
        
        relay.on('unbanned', (data) => {
    console.log('üîì UNBAN EVENT RECEIVED:', data);
    
    // Clear ban from localStorage
    const banKey = `_ban_${userProfile.username}`;
    localStorage.removeItem(banKey);
    
    alert(`üîì Your ban has been removed by ${data.unbannedBy}\n\nYou can now use all features again!`);
    
    // Remove ban screen if it exists
    const banScreen = document.getElementById('banScreen');
    if (banScreen) {
        banScreen.remove();
    }
    
    // Re-enable chat if it was disabled
    const chatInput = document.getElementById('chatInput');
    if (chatInput) {
        chatInput.disabled = false;
        chatInput.placeholder = 'Type a message...';
    }
});

 relay.on('muted', (data) => {
            console.log('üîá MUTE EVENT RECEIVED:', data);
            
           
            if (userProfile.status === 'owner') {
                console.log('Owner is immune to mutes');
                return;
            }
            
            const muteData = {
                until: data.until,
                mutedBy: data.mutedBy
            };
            setMuteData(muteData);  // Use the function, not direct localStorage
            
            alert(`üîá You have been muted for ${data.hours} hours by ${data.mutedBy}`);
            
            const chatInput = document.getElementById('chatInput');
            if (chatInput) {
                chatInput.disabled = true;
                chatInput.placeholder = `Muted for ${data.hours} hours`;
            }
        });
        relay.on('unmuted', (data) => {
    console.log('üîä UNMUTE EVENT RECEIVED:', data);
    

    localStorage.removeItem('_muteData');
    
    alert(`üîä Your mute has been removed by ${data.unmutedBy}`);

    const chatInput = document.getElementById('chatInput');
    if (chatInput) {
        chatInput.disabled = false;
        chatInput.placeholder = 'Type a message...';
    }
});

        relay.on('rank_changed', (data) => {
            console.log('üéñÔ∏è RANK CHANGE RECEIVED:', data);
            console.log('Old status:', userProfile.status);
            console.log('New status:', data.newRank);
            
            userProfile.status = data.newRank;
            
            try {
                localStorage.setItem('userProfile', JSON.stringify(userProfile));
                console.log('‚úÖ Profile saved with new rank');
            } catch(e) {
                console.error('‚ùå Failed to save profile:', e);
            }
            
            updateUserDisplay();
            applyStaffBenefits();
            
            const staffRanks = ['owner', 'sr.admin', 'admin', 'moderator'];
            if (staffRanks.includes(data.newRank)) {
                document.getElementById('adminPanelBtn').style.display = 'block';
            } else {
                document.getElementById('adminPanelBtn').style.display = 'none';
            }
            
            alert(`üéñÔ∏è Your rank has been changed to ${data.newRank} by ${data.changedBy}`);
            
            setTimeout(() => {
                updateUserDisplay();
                updateCoinDisplay();
            }, 100);
        });
        
        console.log('üîå Connecting to relay server...');
        await relay.connect();
        
        console.log('‚úÖ Connected! Now joining room...');
        updateConnectionStatus(true);
        
        console.log('üìç Joining room:', currentChatRoom, 'as', userProfile.username);
        relay.joinRoom(currentChatRoom, userProfile.username, userProfile.status);
        console.log('‚úÖ Join request sent!');
        

// Chat tab switching
document.getElementById('globalChatTab')?.addEventListener('click', () => {
    switchChatRoom('global_chat');
});

document.getElementById('staffChatTab')?.addEventListener('click', () => {
    switchChatRoom('staff_chat');
});

function switchChatRoom(room) {
    if (room === 'staff_chat') {
        const staffRanks = ['owner', 'sr.admin', 'admin', 'moderator'];
        if (!staffRanks.includes(userProfile.status)) {
            alert('Staff only!');
            return;
        }
    }
    

    if (relay && relay.connected) {
        relay.send({ type: 'leave' });
    }
    

    document.getElementById('chatMessages').innerHTML = '';
    
 
    currentChatRoom = room;
    
    
    document.getElementById('globalChatTab')?.classList.toggle('active', room === 'global_chat');
    document.getElementById('staffChatTab')?.classList.toggle('active', room === 'staff_chat');
    document.getElementById('chatTitle').textContent = room === 'staff_chat' ? 'Staff Chat' : 'Global Chat';
    

    if (relay && relay.connected) {
        relay.joinRoom(room, userProfile.username, userProfile.status);
    }
}
        
      
        relay.on('chat_message', (data) => {
            displayChatMessage(data.message, true);
            
            if (!chatOpen) {
                unreadMessages++;
                document.getElementById('chatToggleBtn').classList.add('has-unread');
            }
        });
        
        relay.on('player_joined', (data) => {
    addSystemMessage(`${data.player.username} joined the chat`);
    // Player count updated via heartbeat/players_update
});

relay.on('player_left', (data) => {
    addSystemMessage(`${data.player.username} left the chat`);
    // Player count updated via heartbeat/players_update
});
        
        relay.on('donation', (data) => {
    if (data.targetUsername === userProfile.username) {
        // Receive the donation
        if (data.donationType === 'coins') {
            coins += data.amount;
            setCoins(coins);
        } else if (data.donationType === 'gems') {
            userProfile.gems = (userProfile.gems || 0) + data.amount;
            saveUserProfile(userProfile);
        }
        updateCoinDisplay();
        
        // Check if donation was from owner
        if (data.senderStatus === 'owner') {
            localStorage.setItem('_receivedOwnerDonation_' + userProfile.username, '1');
            checkNametags();
        }
        
        // Show notification
        addSystemMessage(`üí∞ You received ${data.amount} ${data.donationType} from ${data.from}!`);
        
        // Show visual notification
        const notification = document.createElement('div');
        notification.style.cssText = `
            position: fixed;
            top: 80px;
            right: 20px;
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            border: 2px solid #ffd700;
            border-radius: 12px;
            padding: 15px 25px;
            z-index: 10001;
            color: #000;
            font-weight: bold;
            font-size: 16px;
            box-shadow: 0 4px 15px rgba(251, 191, 36, 0.4);
            animation: slideInRight 0.3s ease-out, fadeOutRight 0.3s ease-in 2.7s;
        `;
        notification.innerHTML = `üí∞ Received ${data.amount} ${data.donationType} from ${data.from}!`;
        document.body.appendChild(notification);
        
        setTimeout(() => {
            notification.remove();
        }, 3000);
    }
});;
        
    } catch (error) {
        console.error('Failed to connect to chat:', error);
        addSystemMessage('Failed to connect to chat server');
        updateConnectionStatus(false);
    }
}


function updateConnectionStatus(connected) {
    const status = document.getElementById('connectionStatus');
    if (connected) {
        status.textContent = 'Online';
        status.className = 'connection-status connected';
    } else {
        status.textContent = 'Offline';
        status.className = 'connection-status disconnected';
    }
}

function updateOnlineCount() {
    document.getElementById('chatOnlineCount').textContent = `‚Ä¢ ${onlineCount} online`;
}

function displayChatMessage(message, shouldScroll = true) {
    const messagesContainer = document.getElementById('chatMessages');
    const msgDiv = document.createElement('div');
    msgDiv.className = 'chat-message';
    
    const statusClass = message.status || 'player';
    
    // Debug log to see what we're receiving
    console.log('Chat message received:', message);
    
    // Create nametag badge HTML
    let nametagHtml = '';
    if (message.nametag && message.nametag !== 'none') {
        nametagHtml = `<span class="chat-nametag-badge ${message.nametag}">${message.nametag.toUpperCase()}</span>`;
    }
    
    // Create status badge HTML (always show)
    const statusHtml = `<span class="chat-status-badge ${statusClass}">${statusClass.toUpperCase()}</span>`;
    
    msgDiv.innerHTML = `
        <div>
            <span class="chat-username">${escapeHtml(message.username)}</span>
            ${statusHtml}
            ${nametagHtml}
        </div>
        <span class="chat-text">${escapeHtml(message.message)}</span>
    `;
    
    messagesContainer.appendChild(msgDiv);
    
    if (shouldScroll) {
        messagesContainer.scrollTop = messagesContainer.scrollHeight;
    }
}

function addSystemMessage(text) {
    const messagesContainer = document.getElementById('chatMessages');
    const msgDiv = document.createElement('div');
    msgDiv.className = 'chat-message chat-system';
    msgDiv.textContent = text;
    messagesContainer.appendChild(msgDiv);
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
}


function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}

function toggleChat() {
    chatOpen = !chatOpen;
    const container = document.getElementById('chatContainer');
    
    if (chatOpen) {
        container.classList.add('show');
        unreadMessages = 0;
        document.getElementById('chatToggleBtn').classList.remove('has-unread');
        document.getElementById('chatInput').focus();
        document.getElementById('chatMessages').scrollTop = document.getElementById('chatMessages').scrollHeight;
    } else {
        container.classList.remove('show');
    }
}

function sendChatMessage() {
    const muteStatus = checkMuteStatus();
    if (muteStatus.muted) {
        alert(`üîá You are muted for ${muteStatus.hoursRemaining} more hours by ${muteStatus.mutedBy}`);
        return;
    }
    
    const input = document.getElementById('chatInput');
    const message = input.value.trim();
    
    if (message && relay && relay.connected) {
        relay.send({
            type: 'chat',
            message: message,
            nametag: userProfile.nametag.equipped,
            room: currentChatRoom 
        });
        input.value = '';
    }
}
// Event listeners
document.getElementById('chatToggleBtn').addEventListener('click', toggleChat);
document.getElementById('closeChat').addEventListener('click', toggleChat);

document.getElementById('chatInput').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
        sendChatMessage();
    }
});

// Initialize chat when logged in
if (localStorage.getItem('good') === '1') {
    initChat();
        setTimeout(() => {
        const muteStatus = checkMuteStatus();
        if (muteStatus.muted) {
            const chatInput = document.getElementById('chatInput');
            if (chatInput) {
                chatInput.disabled = true;
                chatInput.placeholder = `Muted for ${muteStatus.hoursRemaining} hours`;
            }
        }
    }, 1000);
}
function sendGlobalDonation() {
    const username = document.getElementById('globalDonateUsername').value.trim();
    const amount = parseInt(document.getElementById('globalDonateAmount').value);
    const type = document.getElementById('globalDonateType').value;
    
    if (!username || !amount || amount <= 0) {
        alert('Please enter a valid username and amount');
        return;
    }
    
    const balance = type === 'coins' ? coins : (userProfile.gems || 0);
    
    if (balance < amount) {
        alert(`Not enough ${type}! You have ${balance} ${type}.`);
        return;
    }
    
    if (!confirm(`Send ${amount} ${type} to ${username}?`)) {
        return;
    }
    
    if (type === 'coins') {
        coins -= amount;
        setCoins(coins);
        updateCoinDisplay();
    } else {
        userProfile.gems -= amount;
        saveUserProfile(userProfile);
        updateCoinDisplay();
    }

    userProfile.totalDonated = (userProfile.totalDonated || 0) + amount;
    saveUserProfile(userProfile);
    checkNametags();
    
    if (relay && relay.connected) {
        relay.send({
            type: 'donation',
            targetUsername: username,
            amount: amount,
            donationType: type,
            from: userProfile.username,
            senderStatus: userProfile.status  
        });
        
        addSystemMessage(`You sent ${amount} ${type} to ${username}`);
    }

    document.getElementById('globalDonateUsername').value = '';
    document.getElementById('globalDonateAmount').value = '';
}
function generateSaveId() {
  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
  let id = '';
  for (let i = 0; i < 32; i++) {
    id += chars.charAt(Math.floor(Math.random() * chars.length));
  }
  return id;
}

function getSaveId() {
  let saveId = localStorage.getItem('_saveId');
  if (!saveId) {
    saveId = generateSaveId();
    localStorage.setItem('_saveId', saveId);
    console.log('Generated new save ID:', saveId);
  }
  return saveId;
}

function toggleSavePanel() {
  const panel = document.getElementById('saveLoadPanel');
  const isVisible = panel.style.display === 'block';
  
  if (!isVisible) {
    const saveId = getSaveId();
    document.getElementById('displaySaveId').textContent = saveId;
  }
  
  panel.style.display = isVisible ? 'none' : 'block';
}

function closeSavePanel() {
  document.getElementById('saveLoadPanel').style.display = 'none';
}

function copySaveId() {
  const saveId = getSaveId();
  navigator.clipboard.writeText(saveId).then(() => {
    alert('‚úÖ Save ID copied to clipboard!');
  }).catch(() => {
    prompt('Copy this ID:', saveId);
  });
}

function saveGame() {
  if (!relay || !relay.connected) {
    alert('‚ùå Not connected to server');
    return;
  }
  
  const saveId = getSaveId();
  const saveData = {};
  
  for (let i = 0; i < localStorage.length; i++) {
    const key = localStorage.key(i);
    saveData[key] = localStorage.getItem(key);
  }
  
  relay.send({
    type: 'save_game',
    saveId: saveId,
    saveData: saveData
  });
  
  relay.on('save_result', (data) => {
    if (data.success) {
      alert('‚úÖ Game saved successfully!');
    } else {
      alert('‚ùå Save failed: ' + data.message);
    }
  });
}

function showLoadPrompt() {
  const inputId = prompt('Enter your Save ID:');
  if (!inputId || inputId.length !== 32) {
    alert('‚ùå Invalid Save ID (must be 32 characters)');
    return;
  }
  
   loadSavedGame(inputId);
}

function loadSavedGame(saveId) {  // ‚Üê RENAMED
  if (!relay || !relay.connected) {
    alert('‚ùå Not connected to server');
    return;
  }
  
  relay.send({
    type: 'load_game',
    saveId: saveId
  });
  
  relay.on('load_result', (data) => {
    if (data.success) {
      localStorage.clear();
      
      for (const [key, value] of Object.entries(data.data)) {
        localStorage.setItem(key, value);
      }
      
      alert('‚úÖ Game loaded! Page will reload...');
      setTimeout(() => location.reload(), 1000);
    } else {
      alert('‚ùå Load failed: ' + data.message);
    }
  });
}


if (localStorage.getItem('good') === '1') {
  const saveId = getSaveId();
  if (!localStorage.getItem('_saveIdShown')) {
    localStorage.setItem('_saveIdShown', '1');
    setTimeout(() => {
      alert(`üîë YOUR SAVE ID: ${saveId}\n\n‚ö†Ô∏è COPY THIS AND SAVE IT SOMEWHERE SAFE!\nYou'll need it to restore your progress on other devices.\n\nClick the üíæ button at bottom-right to save/load anytime.`);
    }, 2000);
  }
}
    </script>
    <script src="visualizer.js"></script>

<div id="saveLoadPanel" style="position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: #1a1a1a; border: 2px solid #333; border-radius: 12px; padding: 20px; display: none; z-index: 10000; min-width: 400px;">
  <h3 style="margin-bottom: 15px; text-align: center;">üíæ Save/Load Game</h3>
  
  <div style="margin-bottom: 15px; padding: 10px; background: #0a0a0a; border-radius: 6px;">
    <div style="font-size: 12px; color: #888; margin-bottom: 5px;">Your Save ID:</div>
    <div id="displaySaveId" style="font-family: monospace; font-size: 14px; word-break: break-all; color: #ffd700;"></div>
    <button onclick="copySaveId()" style="margin-top: 8px; padding: 6px 12px; background: #333; border: 1px solid #555; border-radius: 4px; color: #fff; cursor: pointer; font-size: 12px;">üìã Copy ID</button>
  </div>
  
  <div style="display: flex; gap: 10px; margin-bottom: 15px;">
    <button onclick="saveGame()" style="flex: 1; padding: 12px; background: #4ade80; border: none; border-radius: 6px; color: #000; font-weight: bold; cursor: pointer;">üíæ SAVE</button>
    <button onclick="showLoadPrompt()" style="flex: 1; padding: 12px; background: #3b82f6; border: none; border-radius: 6px; color: #fff; font-weight: bold; cursor: pointer;">üì• LOAD</button>
  </div>
  
  <button onclick="closeSavePanel()" style="width: 100%; padding: 8px; background: #333; border: 1px solid #555; border-radius: 6px; color: #fff; cursor: pointer;">Close</button>
</div>

<button id="saveLoadBtn" onclick="toggleSavePanel()" style="position: fixed; bottom: 20px; right: 20px; width: 60px; height: 60px; border-radius: 50%; background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); border: none; font-size: 28px; cursor: pointer; z-index: 9999; box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4); display: flex; align-items: center; justify-content: center;">üíæ</button>
</body>
</html>
